<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3x3 Curve • sfcurve</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="3x3 Curve">
<meta property="og:description" content="sfcurve">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sfcurve</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/hilbert_curve.html">1. Generalized Hilbert Curve</a>
    </li>
    <li>
      <a href="../articles/peano_curve.html">2. Generalized Peano Curve</a>
    </li>
    <li>
      <a href="../articles/meander_curve.html">3. Generalized Meander Curve</a>
    </li>
    <li>
      <a href="../articles/unit_flipping.html">4. Unit flipping</a>
    </li>
    <li>
      <a href="../articles/standard_curves.html">5. Standard curves</a>
    </li>
    <li>
      <a href="../articles/all_3x3_curve.html">6. 3x3 Curve</a>
    </li>
    <li>
      <a href="../articles/meander_4x4_curve.html">7. 4x4 Meander Curve</a>
    </li>
    <li>
      <a href="../articles/h_curve.html">8. H-Curve</a>
    </li>
    <li>
      <a href="../articles/hilbert_3d.html">9. 3D Hilbert curve</a>
    </li>
    <li>
      <a href="../articles/locality.html">10. Locality of various curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/functions.html">Functions</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/sfcurve/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>3x3 Curve</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 data-toc-skip class="date">2024-07-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/sfcurve/blob/HEAD/vignettes/all_3x3_curve.Rmd" class="external-link"><code>vignettes/all_3x3_curve.Rmd</code></a></small>
      <div class="hidden name"><code>all_3x3_curve.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="base-patterns">Base patterns<a class="anchor" aria-label="anchor" href="#base-patterns"></a>
</h2>
<p>We can merge base patterns from the Peano curve and the Meander curve to construct a universe set of base patterns for the general 3x3 space-filling curves.</p>
<p>Please note, base patterns from the Peano curve only contain the “vertical” patterns, and those from the Meander curve only contain the “forward” pattenrs (they are the major rules for the two types of curves). “Horizontal” and “backward” patterns can be obtained by flipping.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sfc_3x3_combined.html">draw_rules_3x3_combined</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="all_3x3_curve_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Note, <code>J</code> from the Peano curve is put into the <code>I</code> base group. And the vertical Peano patterns can also be expanded for the <code>B/D/P/Q/C</code> bases.</p>
</div>
<div class="section level2">
<h2 id="transverse-path">Transverse path<a class="anchor" aria-label="anchor" href="#transverse-path"></a>
</h2>
<p>Since now all Peano base units and Meander base units are included, the transverse paths from level <span class="math inline">\(k\)</span> to level <span class="math inline">\(k+1\)</span> are massive. Let’s try to expand <span class="math inline">\(I_1^{(1)}\)</span> to the next level.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="va">p</span> <span class="op">=</span> <span class="va">SFC_RULES_3x3_COMBINED</span><span class="op">@</span><span class="va">rules</span><span class="op">$</span><span class="va">I</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">p</span></span></code></pre></div>
<pre><code><span><span class="co">## A sequence of 9 base patterns.</span></span>
<span><span class="co">##   I(0)I(0)R(0)R(270)  I(180)L(180)L(270)I(0)</span></span>
<span><span class="co">##   I(0)</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pl</span> <span class="op">=</span> <span class="fu"><a href="../reference/transverse_path.html">all_transverse_paths</a></span><span class="op">(</span><span class="va">SFC_RULES_3x3_COMBINED</span>, <span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 400</span></span></code></pre>
<p>The following plot shows all transverse paths for the sequence <code>I(0)I(0)R(0)R(270)I(180)L(180)L(270)I(0)I(0)</code> to level 2.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/transverse_path.html">plot_transverse_paths</a></span><span class="op">(</span><span class="va">SFC_RULES_3x3_COMBINED</span>, <span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="all_3x3_curve_files/figure-html/unnamed-chunk-4-1.png" width="864" style="display: block; margin: auto;"></p>
<p>And the numbers of total transverse paths for other level-1 base patterns:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">b</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"R"</span>, <span class="st">"L"</span>, <span class="st">"U"</span>, <span class="st">"B"</span>, <span class="st">"D"</span>, <span class="st">"P"</span>, <span class="st">"Q"</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">SFC_RULES_3x3_COMBINED</span><span class="op">@</span><span class="va">rules</span><span class="op">[[</span><span class="va">b</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">pl</span> <span class="op">=</span> <span class="fu"><a href="../reference/transverse_path.html">all_transverse_paths</a></span><span class="op">(</span></span>
<span>            <span class="va">SFC_RULES_3x3_COMBINED</span>, </span>
<span>            <span class="va">SFC_RULES_3x3_COMBINED</span><span class="op">@</span><span class="va">rules</span><span class="op">[[</span><span class="va">b</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">b</span>, <span class="st">"_"</span>, <span class="va">i</span>, <span class="st">": "</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span>, <span class="st">"\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## I_1: 216</span></span>
<span><span class="co">## I_2: 216</span></span>
<span><span class="co">## I_3: 400</span></span>
<span><span class="co">## I_4: 400</span></span>
<span><span class="co">## R_1: 288</span></span>
<span><span class="co">## R_2: 153</span></span>
<span><span class="co">## R_3: 300</span></span>
<span><span class="co">## L_1: 153</span></span>
<span><span class="co">## L_2: 288</span></span>
<span><span class="co">## L_3: 300</span></span>
<span><span class="co">## U_1: 204</span></span>
<span><span class="co">## U_2: 204</span></span>
<span><span class="co">## B_1: 216</span></span>
<span><span class="co">## B_2: 153</span></span>
<span><span class="co">## B_3: 300</span></span>
<span><span class="co">## D_1: 153</span></span>
<span><span class="co">## D_2: 216</span></span>
<span><span class="co">## D_3: 300</span></span>
<span><span class="co">## P_1: 228</span></span>
<span><span class="co">## P_2: 171</span></span>
<span><span class="co">## P_3: 300</span></span>
<span><span class="co">## Q_1: 228</span></span>
<span><span class="co">## Q_2: 171</span></span>
<span><span class="co">## Q_3: 300</span></span>
<span><span class="co">## C_1: 171</span></span>
<span><span class="co">## C_2: 171</span></span>
<span><span class="co">## C_3: 225</span></span>
<span><span class="co">## C_4: 225</span></span></code></pre>
<p>In the Peano curve, all level-1 patterns have the corner values of <code>(1, 1)</code> or <code>(2, 2)</code>. In the following, we can see the Peano curve only has one specific transverse path on any level <span class="math inline">\(k\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/transverse_path.html">plot_transverse_paths</a></span><span class="op">(</span><span class="va">SFC_RULES_3x3_COMBINED</span>, <span class="va">p</span>, type <span class="op">=</span> <span class="st">"11|22"</span><span class="op">)</span></span></code></pre></div>
<p><img src="all_3x3_curve_files/figure-html/unnamed-chunk-6-1.png" width="864" style="display: block; margin: auto;"></p>
<p>For the Meander curve, the corner values are always <code>(1, 2)</code> or <code>(2, 1)</code>. There are always two transverse paths for any given <span class="math inline">\(k\)</span>. If the transverse code for the first base pattern is determined, the whole transverse path is then fixed.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/transverse_path.html">plot_transverse_paths</a></span><span class="op">(</span><span class="va">SFC_RULES_3x3_COMBINED</span>, <span class="va">p</span>, type <span class="op">=</span> <span class="st">"12|21"</span><span class="op">)</span></span></code></pre></div>
<p><img src="all_3x3_curve_files/figure-html/unnamed-chunk-7-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="number-of-different-forms">Number of different forms<a class="anchor" aria-label="anchor" href="#number-of-different-forms"></a>
</h2>
<p>Let’s make an assumption: for a general 3x3 curve that expands from level <span class="math inline">\(k\)</span> with <span class="math inline">\(n\)</span> points (<span class="math inline">\(n = 9^{k}\)</span>) to level <span class="math inline">\(k+1\)</span>, the total number of transverse paths denoted as <span class="math inline">\(t_k\)</span> is:</p>
<p><span class="math display">\[
t_k \approx \alpha^n
\]</span></p>
<p>Since in a 3x3 curve, base patterns have either three or four transverse codes, let’s consider a sequence with <span class="math inline">\(n\)</span> base patterns of <span class="math inline">\(I\)</span>. Let’s start from the first base pattern. From the second one, a base pattern can connect to two following base patterns (e.g. (1, 1) at position 1 can only connect to (2, 1) and (2, 2)), then the total number of transverse paths with a fixed position 1 is <span class="math inline">\(2^{n-1}\)</span>. By taking all four base patterns at position 1, the final number of transverse paths for <span class="math inline">\(n\)</span> base patterns are <span class="math inline">\(4 \cdot 2^{n-1} = 2 \cdot 2^n\)</span>, which is the possible maximal number of total transverse paths for a sequence of length <span class="math inline">\(n\)</span>.</p>
<p>Then</p>
<p><span class="math display">\[
\begin{align*}
\alpha^{n} &amp;= 2 \cdot 2^n \\
\alpha &amp;= 2 \cdot 2^{1/n} \\
\end{align*}
\]</span></p>
<p>Normally <span class="math inline">\(n\)</span> is huge, which results in:</p>
<p><span class="math display">\[
\alpha_\mathrm{max} \approx 2
\]</span></p>
<p>For the minimal case, there is only one transverse path for <span class="math inline">\(n\)</span> base patterns, thus</p>
<p><span class="math display">\[\alpha_\mathrm{min} = 1\]</span></p>
<p>So <span class="math inline">\(\alpha\)</span> is approximately a number between 1 and 2.</p>
<p>Next let’s calculate the number of different forms of 3x3 curve on each level:</p>
<p><span class="math display">\[
\begin{align*}
n_1 &amp;= n_0 \\
n_2 &amp;= n_1 \cdot t_1  = n_1 \cdot \alpha_1^{9^1}\\
    &amp; ... \\
n_k &amp;= n_{k-1} \cdot t_{k-1}  = n_{k-1} \cdot \alpha_{k-1}^{9^{k-1}}\\
\end{align*}
\]</span></p>
<p>Then we can calculate <span class="math inline">\(n_k\)</span> as</p>
<p><span class="math display">\[
n_k = n_0 \cdot \alpha_1^{9^1} \cdot \alpha_2^{9^2} ... \alpha_{k-1}^{9^{k-1}} 
\]</span></p>
<p>If we approximately take all <span class="math inline">\(\alpha_i\)</span> are similar:</p>
<p><span class="math display">\[
n_k \approx n_0 \cdot \alpha^{\frac{9^k -9}{8}}
\]</span></p>
<p>where <span class="math inline">\(n_0 = 3\)</span> or <span class="math inline">\(n_0 = 4\)</span>.</p>
<p>By also considering the 9 flipped rules and the 4 rotations, and each unit on different level can be flipped (vertically/horizontally/by diagonal) independently, the final number of all possible forms of 3x3 curves is approximate</p>
<p><span class="math display">\[
9 \cdot 4 \cdot n_0 \cdot \alpha^{\frac{9^k -9}{8}} \cdot 2^{\frac{9^k - 1}{8}}
\]</span></p>
</div>
<div class="section level2">
<h2 id="curves">Curves<a class="anchor" aria-label="anchor" href="#curves"></a>
</h2>
<p><code><a href="../reference/sfc_3x3_combined.html">sfc_3x3_combined()</a></code> generates a curve where on each level, a transverse path is randomly selected.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/sfc_3x3_combined.html">sfc_3x3_combined</a></span><span class="op">(</span><span class="st">"I"</span>, level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_3x3_combined.html">sfc_3x3_combined</a></span><span class="op">(</span><span class="st">"I"</span>, level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_3x3_combined.html">sfc_3x3_combined</a></span><span class="op">(</span><span class="st">"I"</span>, level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_3x3_combined.html">sfc_3x3_combined</a></span><span class="op">(</span><span class="st">"I"</span>, level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="all_3x3_curve_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  <style>nav[data-toggle='toc'] .nav .nav {display: block;}</style>
</body>
</html>
