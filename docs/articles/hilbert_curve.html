<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generalized Hilbert Curve • sfcurve</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Hilbert Curve">
<meta property="og:description" content="sfcurve">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sfcurve</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/hilbert_curve.html">Generalized Hilbert Curve</a>
    </li>
    <li>
      <a href="../articles/peano_curve.html">Generalized Peano Curve</a>
    </li>
    <li>
      <a href="../articles/meander_curve.html">Generalized Meander Curve</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/sfcurve/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Generalized Hilbert Curve</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 data-toc-skip class="date">2024-07-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/sfcurve/blob/HEAD/vignettes/hilbert_curve.Rmd" class="external-link"><code>vignettes/hilbert_curve.Rmd</code></a></small>
      <div class="hidden name"><code>hilbert_curve.Rmd</code></div>

    </div>

    
    
<p>We only consider the type of space-filling curve that has a <span class="math inline">\(2^k \times 2^k\)</span> rate. The growth of the curve can be described in a top-bottom manner, where within a square with fixed size (normally a unit square), the square is partitioned into four sub-square by euqally split it into two halves on horizonally and verically. Then on each subsquare, such partitioning is applied recursively. It can also be described in a bottom-top manner, where with a unit square expands into four squares by increase 2x both on rows and columns, then for each of the four square, it expands recursively. It is easy to see, the two ways are identically only with a size factor <span class="math inline">\(n\)</span> (the xx) or <span class="math inline">\(n^2\)</span> (the area).</p>
<p>For easy discussion, we use the expansion mode. When expanding one square to four squares (2x2), there are several ways, such as the z-curve or H-curve. We requiare the curve can only goes straight, left or right along the four squares without interuptted or crossing</p>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-2-1.png" width="460.8" style="display: block; margin: auto;"></p>
<div class="section level2">
<h2 id="base-patterns">Base patterns<a class="anchor" aria-label="anchor" href="#base-patterns"></a>
</h2>
<p>The space-filling curve can be generated by recursively extending certain patterns on its sub-structures. Thus, we define the following expansion rules from level 0 to level 1. The patterns on level 0 are alled the <strong>base patterns</strong> which contains a single points and its in-direction and out-direction.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_rules.html">draw_rules_hilbert</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-3-1.png" width="768" style="display: block; margin: auto;"></p>
<p>For example, base pattern <span class="math inline">\(I\)</span> is on level 0, explicitly denoted as <span class="math inline">\(I^{(0)}\)</span>, when it expands to level 1 while keep the direction of the curve, There are two options as listed in the diagram. As an example here, we choose the first option. Now for the following expansion:</p>
<p><span class="math display">\[
I^{(0)} \rightarrow I^{(1)}_1
\]</span></p>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-4-1.png" width="124.8" style="display: block; margin: auto;"></p>
<p>we can describe the curve generation in four steps:</p>
<ul>
<li>step 1. bottom in, right out. This is the base pattern <span class="math inline">\(R\)</span> without rotation, thus we denote it as <span class="math inline">\(R^{(0)}\)</span>,</li>
<li>step 2. left in, top out. This is the base pattern <span class="math inline">\(L\)</span> with <span class="math inline">\(90^{\circ}\)</span> clockwise rotation, thus we denote it as <span class="math inline">\(L^{(0),90}\)</span>,</li>
<li>step 3. bottom in, left out. This is the base pattern <span class="math inline">\(L\)</span> without rotation, and we denote it as <span class="math inline">\(L^{(0)}\)</span>,</li>
<li>step 4. right in, top out. This step can be denoted as <span class="math inline">\(R^{(0),-90}\)</span> or <span class="math inline">\(R^{(0),270}\)</span>.</li>
</ul>
<p>Then the expansion can be written as a sequence:</p>
<p><span class="math display">\[
I^{(1)}_1 = R^{(0)}L^{(0),90}L^{(0)}R^{(0),270}
\]</span></p>
<p>In figure 1, the notatio of levels are removed since it can be easily identified.</p>
</div>
<div class="section level2">
<h2 id="rotate">Rotate<a class="anchor" aria-label="anchor" href="#rotate"></a>
</h2>
<p>Figure 1 only contains base patterns at rotation = 0, but we can easily define the rations of a pattern or a sequence of patterns.</p>
<p>Denote <span class="math inline">\(X\)</span> as a base pattern, <span class="math inline">\(X \in \{I, R, L, U, C, B, D, P, Q\}\)</span>, and <span class="math inline">\(X^\theta\)</span> where <span class="math inline">\(\theta\)</span> is the rotation regarding to the base state in Figure 1. <span class="math inline">\(\theta \in \{0, 90, 180, 270\}\)</span> and a positive <span class="math inline">\(\theta\)</span> corresponds to clocewise rotation, we have</p>
<p><span class="math display">\[ (X^{\theta_1})^{\theta_2} = X^{\theta_1 + \theta_2} \]</span></p>
<p>which means rotating the pattern twice is identical to rotating the pattern once but with the sum of the two rotations.</p>
<p>Note</p>
<p><span class="math display">\[
X^\theta = X^{\theta \bmod 360}
\]</span></p>
<p>Rotating a sequence of base patterns is identical to a sequence of rotated base patterns.</p>
<p><span class="math display">\[
(X_1^{\theta_1}X_2^{\theta_2}...X_n^{\theta_n})^\theta'  = X_1^(\theta_1 + \theta') X_2^(\theta_2 + \theta1) ... X_n^(\theta_n + \theta')
\]</span></p>
<p>By also include all four rotations of the base patterns, Figure 1 contains the complete set of expansion from level 0 to level 1.</p>
</div>
<div class="section level2">
<h2 id="expanding-the-curve">Expanding the curve<a class="anchor" aria-label="anchor" href="#expanding-the-curve"></a>
</h2>
<p>Figure 1 only defines the expansion of the curve from level 0 to level 1 (the 0-to-1 expansion). To expand the curve to higher levels, e.g. to level <span class="math inline">\(k\)</span> (<span class="math inline">\(k &gt; 1\)</span>), the 0-to-1 expansion can be applied recursively. Note a level-<span class="math inline">\(k\)</span> curve is a sequence of four level-<span class="math inline">\(k-1\)</span> curves, which eventually a sequence of <span class="math inline">\(4^{k-1}\)</span> level-1 curves. As for each base pattern, to expand to level-1, there are two options, thus there are rules to pick one of the options in the expansion to ensure all the level-1 curves are connected to their neighbour level-1 curves.</p>
<div class="section level3">
<h3 id="transverse-mode">Transverse mode<a class="anchor" aria-label="anchor" href="#transverse-mode"></a>
</h3>
<p>All the level-1 curves transverse a <span class="math inline">\(2 \times 2\)</span> grids, thus they all have a rectangle-shape with an in-direction and an out-direction. Denote the bottom left and top right have a corner value of 1 and the top left and bottom right have a corner value of 2.</p>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-5-1.png" width="192" style="display: block; margin: auto;"></p>
<p>We define the <strong>transverse mode</strong> <span class="math inline">\(\tau\)</span> of the level-1 curve <span class="math inline">\(X^{(1)}\)</span> as a 2-tuple <span class="math inline">\((c_1, c_2)\)</span> where <span class="math inline">\(c_1\)</span> is the value of the entering corner and <span class="math inline">\(c_2\)</span> is the value of the leaving corner of <span class="math inline">\(X^{(1)}\)</span>:</p>
<p><span class="math display">\[
\tau_{X^{(1)}} = (c_1, c_2), \quad c_1, c_2 \in \{1, 2\}
\]</span></p>
<p>In Figure 1, <span class="math inline">\(\tau_{X^{(1)}} = (1, 2)\)</span> or <span class="math inline">\(\tau_{X^{(1)}} = (2, 1)\)</span>, so we define the complement of a corner value as</p>
<p><span class="math display">\[
\hat{c} = \left\{\begin{matrix}
2 &amp; \text{if }c = 1,\\ 
1 &amp; \text{if }c = 2,\\ 
\end{matrix}\right.
\]</span></p>
<p>Rotating <span class="math inline">\(X^{(1)}\)</span> <span class="math inline">\(90^\circ\)</span> (either clockwise or reverse clockwise) changes the order of the two corner values in the tuple, while rotating by <span class="math inline">\(180^\circ\)</span> does not.</p>
<p><span class="math display">\[
\begin{align*}
\tau_{X^{(1), 90k}} &amp;= (c_1, c_2), &amp; \text{if }k\text{ is even}, \\
\tau_{X^{(1), 90k}} &amp;= (\hat{c}_1, \hat{c}_2), &amp; \text{if }k\text{ is odd}, \\
\tau_{X^{(1), 180k}} &amp;= (c_1, c_2) \\
\end{align*}
\]</span></p>
<p>Let’s go back to Figure 1. For each base pattern, there are two level-1 curve that can be expanded. The two curves have different transverse mode. We code the two level-1 curves according to their transverse mode as:</p>
<p><span class="math display">\[
\begin{align*}
X_1^{(1)} \quad \text{if }\tau_{X^{(1)}} &amp;= (1, 2), \\
X_2^{(1)} \quad \text{if }\tau_{X^{(1)}} &amp;= (2, 1). \\
\end{align*}
\]</span></p>
</div>
<div class="section level3">
<h3 id="connect-patterns">Connect patterns<a class="anchor" aria-label="anchor" href="#connect-patterns"></a>
</h3>
<p>For two level-1 curves <span class="math inline">\(X^{(1)}\)</span> and <span class="math inline">\(Y^{(1)}\)</span> with transverse modes <span class="math inline">\((c_1, c_2)\)</span> and <span class="math inline">\((c_3, c_4)\)</span> (of course <span class="math inline">\(c_2 = \hat{c_1}\)</span>, <span class="math inline">\(c_4 = \hat{c_3}\)</span>), to construct the sequence <span class="math inline">\(XY\)</span>, we need to ensure the two curves are connectable. Since the two curves represented as two square patterns can only be connected horizontally or vertically, it should fit <span class="math inline">\(c_3 = c_4\)</span>, i.e. with the forms of <span class="math inline">\(\tau_{X^{(1)}} = (1, 2)\)</span> and <span class="math inline">\(\tau_{y^{(1)}} = (2,1)\)</span> or <span class="math inline">\(\tau_{X^{(1)}} = (2, 1)\)</span> and <span class="math inline">\(\tau_{y^{(1)}} = (1,2)\)</span>.</p>
<p>From a base pattern, there are two options of level-1 curves. To connect two level-1 curve, we first need to pre-select the expansion code of the first level-1 curve, then the expansion code for the following level-1 curves can be automatically inferred.</p>
<p>Let’s denote two level-1 curves <span class="math inline">\(X^{(1),\alpha} Y^{(1),\beta}\)</span>, we first assign an expansion code to the first curve, say <span class="math inline">\(X_i^{(1),\alpha}\)</span> (<span class="math inline">\(i \in \{1,2\}\)</span>), and we define the complement expansion code <span class="math inline">\(j\)</span> as:</p>
<p><span class="math display">\[
j = \left\{\begin{matrix}
1 &amp; \text{if }i = 2,\\ 
2 &amp; \text{if }i = 1.\\ 
\end{matrix}\right.
\]</span></p>
<p>then the expansion code for <span class="math inline">\(Y^{(1),\beta}\)</span> is determined by <span class="math inline">\(k = (\beta - \alpha)/90\)</span>:</p>
<p><span class="math display">\[
\left\{\begin{matrix}
Y^{(1),\beta}_i, &amp; \text{if }k\text{ is even}, \\
Y^{(1),\beta}_j, &amp; \text{if }k\text{ is odd}. \\
\end{matrix}\right.
\]</span></p>
<p>which means if <span class="math inline">\(\beta-\alpha\)</span> is the even multiple of <span class="math inline">\(90^\circ\)</span>, <span class="math inline">\(Y^{(1),\beta}\)</span> has the same expansion code as <span class="math inline">\(X^{(1),\alpha}\)</span>, or <span class="math inline">\(90^\circ\)</span>, <span class="math inline">\(Y^{(1),\beta}\)</span> has the complement code of <span class="math inline">\(X^{(1),\alpha}\)</span>.</p>
<p>so for example, starting from <span class="math inline">\(I^{90}\)</span>, to extend it, we choose <span class="math inline">\(I_1^{90}\)</span> with the level 1 form</p>
<p><span class="math display">\[
I_1^{90} = (RL^{90}LR^{270})^{90} = R^{90}L^{180}L^{90}R
\]</span></p>
<p>To extend to level 2, we have to assign the type code to each of the RLRL to extend, we start from the first pattern R, as there are two options, we use <span class="math inline">\(R_1\)</span>, then according to the rules</p>
<p><span class="math display">\[
I_1 = R_1^{90}L_2^{180}L_1^{90}R_2
\]</span> then by … we can obtian the final sequence on level 3:</p>
<p><span class="math display">\[
(IRR^{90}L^{180})^{90}(ILL^{270}R^{180})^{180}(RL^{90}LI^{270})^{90}(LR^{270}RI^{90})
= I^{90}R^{90}R^{180}L^{270}I^{180}L^{180}L^{90}RR^{90}L^{180}L^{90}ILR^{270}RI^{90}
\]</span></p>
<p>If we only want to expand to level 3 then the pattern code in the prevous equation already corresponds to the base patterns. In this way, with knowing the sequence, the ratation is determined and can be removed</p>
<p><span class="math display">\[
I^{90}|srrlsllrrllslrrl
\]</span></p>
<p>In the direction of approaching, wiht the initial state <span class="math inline">\(I^90\)</span> which means horizontally from left to right, th esequence is</p>
<ul>
<li>
<span class="math inline">\(s\)</span> go straight</li>
<li>
<span class="math inline">\(r\)</span> turn right</li>
<li>
<span class="math inline">\(l\)</span> turn left</li>
</ul>
<p>horizontally from left to right, the moving sequence is straight -&gt; right-&gt;right-&gt;left-&gt;straight-&gt;…</p>
<p>When expanding from level 1 to level 2, the four corners are extended to a grid according to the 0-1 rule, which is</p>
<p>$$</p>
<p>$$</p>
<p>As the selection of 1 and 2 ensures that when extending form level 1 to level 2, the curve is still connected,i.e.</p>
<p><span class="math display">\[C2 = C11C12C13C14\]</span></p>
<p>where <span class="math inline">\(C_2\)</span> is the curve at level 2, C1. are the level 1 curve extended form the four corners and they are connected 1.</p>
<p>One important of such expansion is the transverse mode (e.g. bottom-in and top-out) is unchanged in such expansion, this ensures that the curves between sub-square are connected. Thus</p>
<p><span class="math display">\[
I^{(k)}_1 = R^{(k-1)}L^{(k-1),90}L^{(k-1)}R^{(k-1),270}
\]</span></p>
<p>where <span class="math inline">\(k\)</span> is the level of the curve, or the simple way</p>
<p><span class="math display">\[
I_1 = RL^{90}LR^{270}, k \in \{1, 2, ...\}
\]</span></p>
<p>The diagram contains the complete set of expansion from 0 to 1 with initial rotation of 0. The selection of xx is based on that on level 0, the curve starts from the bottom and the first step is bottom up. Letters R and L means turn right or left. Other letters are selected based on the shapes of letters and xxx. Only B and D do not start from bottom and up, but the initial shape xxx.</p>
</div>
</div>
<div class="section level2">
<h2 id="expand-the-curve">Expand the curve<a class="anchor" aria-label="anchor" href="#expand-the-curve"></a>
</h2>
<p>Let’s start from a single base pattern as the intiali pattern. To recursively expand the curve, since each base pattern has two types of xxx, thus, on easy step, we need to choose the expanded pattern s…</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">include_graphics</span><span class="op">(</span><span class="st">"hc_expand.png"</span><span class="op">)</span></span></code></pre></div>
<p><img src="hc_expand.png" width="70%" style="display: block; margin: auto;"></p>
<p>as shown, on each step, xxx, thus on a level <span class="math inline">\(k\)</span>, the total number of curves are <span class="math inline">\(2^k\)</span>. Taking <span class="math inline">\(R\)</span> as the initial patter and on level 3, the total set of curves are 8:</p>
<p>Note the oritentation of <span class="math inline">\(R\)</span>, bottom in and right out.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Then, with knowing the intial patter and the tye of each step, the curve is fixed. Then we can describe a <span class="math inline">\(2^k \times 2^k\)</span> curve denoted as <span class="math inline">\(\mathcal{C}_k\)</span></p>
<p><span class="math display">\[
\mathcal{C}_k := X^{(0)}|\pi_1 \pi_2 ... \pi_k, \pi_i \in \{1, 2\}
\]</span></p>
<p>note the sequence <span class="math inline">\((\pi_1 \pi_2, ..., \pi_k)\)</span> can be represented as a sequence of binary bits, it can be xxx into an integer</p>
<p><span class="math display">\[
X|111 = X|0_3 \\
X|121 = X|2_3 \\
X|222 = X|7_3
\]</span></p>
<p>We can generate the Hilbert curve, Moore curve and <span class="math inline">\(\beta\Omega\)</span> curve as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"I"</span>, code <span class="op">=</span>  <span class="st">"111"</span>, rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"U"</span>, code <span class="op">=</span>  <span class="st">"211"</span>, rot <span class="op">=</span> <span class="fl">180</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"C"</span>, code <span class="op">=</span> <span class="st">"2121"</span>, rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
<p>In the sequence of type code on levels:</p>
<p><span class="math display">\[
\pi_1, \pi_2, ..., \pi_{k-1}, \pi_{k}
\]</span></p>
<p>The type code on the left of the sequence correspond to the higher level organization of the folding, and codes on the right side correspond to the lower level. Particularlly, the last two type codes which construct the unit of 4x4 is the most observable unit in the curve. If we define the following shape as the basic unit of Hilbert curve</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"11"</span><span class="op">)</span>, extend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-9-1.png" width="192" style="display: block; margin: auto;"></p>
<p>we can have the following curve with the hilbert unit</p>
<p><span class="math display">\[
\mathcal{H}_k := X^{\theta}|\pi_1 \pi_2 ... \pi_{k_-1} \pi_k), where \pi_{k-1} = \pi_k, \theta \in \{0, 90, 180, 270\}
\]</span></p>
<p>on level 2, only <span class="math inline">\(\{I, R, L, U\}\)</span>.</p>
<p>We can also define the <span class="math inline">\(\beta\)</span> unit and the <span class="math inline">\(\Omega\)</span> unit as the following two</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"L"</span>, <span class="st">"21"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"12"</span>, rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-10-1.png" width="384" style="display: block; margin: auto;"></p>
<p>genral <span class="math inline">\(\beta\Omega\)</span> curve (k &gt;= 3)</p>
<p><span class="math display">\[
\mathcal{B}_k := X^{\theta}(\pi_1 \pi_2 ... \pi_{k_-1}, \pi_k), where \pi_{k-1} \ne \pi_k, \theta \in \{0, 90, 180, 270\}
\]</span></p>
<p>A specific base pattern can induce <span class="math inline">\(2^k\)</span> differnet forms of curves on level <span class="math inline">\(k\)</span>, so the total number of the forms for all 9 base patterns with 4 rotations are</p>
<p><span class="math display">\[
4 \times 9 \times 2^k = 36 \times 2^k
\]</span></p>
<p>Prove it contains all form sof “open” curves.</p>
<p>Let’s go back to the sequence of a curve on level k</p>
<p><span class="math display">\[
\mathcal{C}_k = X^{(0)}|\pi_1 \pi_2 ... \pi_k, \pi_i \in \{1, 2\}
\]</span></p>
<p>The equation represents the curve starts from <span class="math inline">\(X^{(0)}\)</span> and expands k xxx. We can merge <span class="math inline">\(X^{(0)}\)</span> and the first expansion as the initial pattern, and xx k-1 times, written as:</p>
<p><span class="math display">\[
\mathcal{C}_k = (X^{(0)}|\pi_1) | \pi_2 ... \pi_k, \pi_i \in \{1, 2\}
\]</span></p>
<p>Similarll we can have move any <span class="math inline">\(\pi_i\)</span> to the left side of <span class="math inline">\(|\)</span>:</p>
<p><span class="math display">\[
\mathcal{C}_k = (X^{(0)}|\pi_1 ... \pi_i) | \pi_(i+1) ... \pi_k
\]</span></p>
<p>or we can write in a pattern, extend 1, a new pattern ,,…</p>
<p><span class="math display">\[
\mathcal{C}_k = {[(X^{(0)}|\pi_1)| \pi_2] | ...}| \pi_k
\]</span></p>
<p>or</p>
<p><span class="math display">\[
\mathcal{C}_k = X^{(0)}|\pi_1 | \pi_2 | ... | \pi_k
\]</span></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial</span> <span class="op">=</span> <span class="fu"><a href="../reference/sfc_sequence.html">sfc_seed</a></span><span class="op">(</span><span class="st">"R"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1212"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1"</span><span class="op">)</span>, <span class="st">"212"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"12"</span><span class="op">)</span>, <span class="st">"12"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"121"</span><span class="op">)</span>, <span class="st">"2"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1212"</span><span class="op">)</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1"</span><span class="op">)</span>, <span class="st">"2"</span><span class="op">)</span>, <span class="st">"1"</span><span class="op">)</span>, <span class="st">"2"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-11-1.png" width="1152" style="display: block; margin: auto;"></p>
<p>we can also merge neighbouring xxx , e.g.</p>
<p><span class="math display">\[
\mathcal{C}_k = X^{(0)}| (\pi_1 \pi_2) | (\pi_3 \pi_4) | ... | (\pi_{k-1} \pi_k
\]</span></p>
<p>This means, instead of doing a 2x2 expansion, now we do a 4x4 expansion, and each expansion mode is determined by <span class="math inline">\((\pi_{i-1} \pi_i\)</span></p>
<p><span class="math display">\[
\lambda = \pi \pi' \\
\lambda = \left\{\begin{matrix}
&amp; 1, \pi \pi' = 1 1 \\
&amp; 2, \pi \pi' = 1 2 \\
&amp; 3, \pi \pi' = 2 1 \\
&amp; 4, \pi \pi' = 2 2 \\
\end{matrix}\right.
\]</span></p>
<p><span class="math display">\[
X|\lambda_1 lambda_2 ... = X|\pi_1\pi_1' \pi_2 \pi_2' ...
\]</span></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span><span class="op">)</span></span>
<span><span class="va">sfc_4x4</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">initial</span>, <span class="va">code</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">map</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"11"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"12"</span>, <span class="st">"3"</span> <span class="op">=</span> <span class="st">"21"</span>, <span class="st">"4"</span> <span class="op">=</span> <span class="st">"22"</span><span class="op">)</span></span>
<span>    <span class="va">code</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">code</span>, <span class="st">""</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">code2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">map</span><span class="op">[</span><span class="va">code</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="va">code2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">initial</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1"</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"3"</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"11"</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"13"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-12-1.png" width="700" style="display: block; margin: auto;"></p>
<p>In some xxx, instead of using single point as the base pattern, some xx use the patterns on level 1, i.e. 2x2 pattern as the base pattern</p>
<p><span class="math display">\[
\mathcal{C}_k = X^{(0)}| (\pi_1))| \pi_2 ... \pi_{k-1} \pi_k
\]</span></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">initial</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"11"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-13-1.png" width="700" style="display: block; margin: auto;"></p>
<p>And to get a full “base pattern” of such</p>
<p><span class="math display">\[
X^{(1),\theta}_\pi, \theta \in \{0, 90, 180, 270\}, \pi \in \{1, 2\}
\]</span></p>
</div>
<div class="section level2">
<h2 id="recursive-pattern">Recursive pattern<a class="anchor" aria-label="anchor" href="#recursive-pattern"></a>
</h2>
<p>Denote a curve as a sequence on level k with 4^k patterns</p>
<p><span class="math display">\[
(X_1 X_2 ... X_{4^k}) = (X_1 ... X_{4^{k-1}})
(X_{4^{k-1} + 1} ... X_{2 \cdot 4^{k-1}})
(X_{2 \cdot 4^{k-1}+1}...X_{3 \cdot 4^{k-1}})
(X_{3 \cdot 4^{k-1} + 1} ... X_{3 \cdot 4^{k}})
\]</span></p>
<p>If each xxx of k-1 can be reduced to a single point</p>
<p>P(k) - P(k-1) = p(1)</p>
<p>P(k) - P(1) = P(k-1)</p>
<p>the we call …</p>
<p>assuption, a recursive patttern has the following form:</p>
<p><span class="math display">\[
X^{\theta}(t_1 t_2, ..., t_{k_-1}, t_k), t_{k-1}, t_1 = t_2 = ... = t_{k-1}
\]</span></p>
</div>
<div class="section level2">
<h2 id="complex-initial">Complex initial<a class="anchor" aria-label="anchor" href="#complex-initial"></a>
</h2>
<p>In the previous curve defintion, X is xx as a single base pattern. There is no restriction ofxx X can be a list of sequence with valid struture.</p>
<p>In the following, the global structure is <span class="math inline">\(I^{90}RL\)</span>, horizonal staring from left, go straight, then turn right and turn left</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"IRL"</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-14-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sfc_sequence.html">sfc_seed</a></span><span class="op">(</span><span class="st">"LLLILILIILIILIIILIIILIIII"</span>, universe <span class="op">=</span> <span class="fu"><a href="../reference/sfc_universe.html">sfc_universe</a></span><span class="op">(</span><span class="va">SFC_RULES_HILBERT</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span>, grid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-15-1.png" width="192" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">p</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-16-1.png" width="480" style="display: block; margin: auto;"></p>
<p>WHen constructing a complex initial pattern sequence, <span class="math inline">\(U\)</span> can only be used to form <span class="math inline">\(UU^{180}\)</span>,</p>
<p><span class="math inline">\(C\)</span> is self-closed and cannot be connected, <span class="math inline">\(B\)</span>, <span class="math inline">\(D\)</span>, <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span> are half-closed and can only be used as the start or end pattern of a sequence.</p>
<p>Note the initiali squence can only be consturcted by “straight”, “lef” and “right”. crossing is not allowed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"IIIIIIIIII"</span>, code <span class="op">=</span> <span class="st">"11111"</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-17-1.png" width="960" style="display: block; margin: auto;"></p>
<p>We can make e.g. circular transformation of the original coordinates</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loc</span> <span class="op">=</span> <span class="fu"><a href="../reference/sfc_segments.html">sfc_segments</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">loc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      [,1] [,2]</span></span>
<span><span class="co">## [1,]    0    0</span></span>
<span><span class="co">## [2,]    0    1</span></span>
<span><span class="co">## [3,]   -1    1</span></span>
<span><span class="co">## [4,]   -1    0</span></span>
<span><span class="co">## [5,]   -2    0</span></span>
<span><span class="co">## [6,]   -3    0</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loc</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/circlize" class="external-link">circlize</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/circos.par.html" class="external-link">circos.par</a></span><span class="op">(</span>gap.degree <span class="op">=</span> <span class="fl">0</span>, cell.padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/circos.initialize.html" class="external-link">circos.initialize</a></span><span class="op">(</span>sectors <span class="op">=</span> <span class="st">"foo"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>, <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">11</span>, <span class="st">"Spectral"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/circos.track.html" class="external-link">circos.track</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, panel.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/circos.segments.html" class="external-link">circos.segments</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="fu">col_fun</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span>, track.height <span class="op">=</span> <span class="fl">0.5</span>, bg.border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/circos.clear.html" class="external-link">circos.clear</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strrep.html" class="external-link">strrep</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="fl">30</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"11111"</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span><span class="va">loc</span> <span class="op">=</span> <span class="fu"><a href="../reference/sfc_segments.html">sfc_segments</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loc</span><span class="op">)</span></span>
<span><span class="va">col_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>, <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">11</span>, <span class="st">"Spectral"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/spiralize" class="external-link">spiralize</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://jokergoo.github.io/spiralize/reference/spiral_initialize.html" class="external-link">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">360</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://jokergoo.github.io/spiralize/reference/spiral_track.html" class="external-link">spiral_track</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">0.95</span>, background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://jokergoo.github.io/spiralize/reference/spiral_segments.html" class="external-link">spiral_segments</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span>, <span class="fl">2</span><span class="op">]</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu">col_fun</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="partial-curve">partial curve<a class="anchor" aria-label="anchor" href="#partial-curve"></a>
</h2>
<p>For a curve xxx . Internally, they are only abstracted as a sequence with no requirement of being square.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"11111"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1024</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">200</span><span class="op">:</span><span class="fl">400</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-21-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="locality">Locality<a class="anchor" aria-label="anchor" href="#locality"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">tl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">^</span><span class="fl">4</span> <span class="op">-</span> <span class="fl">1</span>, <span class="va">int_to_binary</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ml</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tl</span>, <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="va">t</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_segments.html">sfc_segments</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ml2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ml</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">-</span><span class="va">ml</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ml</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">ml</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, cluster_rows <span class="op">=</span> <span class="cn">F</span>, cluster_columns <span class="op">=</span> <span class="cn">F</span>, show_row_names <span class="op">=</span> <span class="cn">F</span>, show_column_names <span class="op">=</span> <span class="cn">F</span>, use_raster <span class="op">=</span> <span class="cn">TRUE</span>, show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">ml2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>, cluster_rows <span class="op">=</span> <span class="cn">F</span>, cluster_columns <span class="op">=</span> <span class="cn">F</span>, show_row_names <span class="op">=</span> <span class="cn">F</span>, show_column_names <span class="op">=</span> <span class="cn">F</span>, use_raster <span class="op">=</span> <span class="cn">TRUE</span>, show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">pl</span>, nrow <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">ml</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"R"</span>, <span class="st">"L"</span>, <span class="st">"U"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"D"</span>, <span class="st">"P"</span>, <span class="st">"Q"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">dist</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_segments.html">sfc_segments</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ml2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ml</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">-</span><span class="va">ml</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">ml</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">ml</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, cluster_rows <span class="op">=</span> <span class="cn">F</span>, cluster_columns <span class="op">=</span> <span class="cn">F</span>, show_row_names <span class="op">=</span> <span class="cn">F</span>, show_column_names <span class="op">=</span> <span class="cn">F</span>, use_raster <span class="op">=</span> <span class="cn">TRUE</span>, show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/grid/grid.grab.html" class="external-link">grid.grabExpr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">ml2</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="fu">circlize</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"white"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>, cluster_rows <span class="op">=</span> <span class="cn">F</span>, cluster_columns <span class="op">=</span> <span class="cn">F</span>, show_row_names <span class="op">=</span> <span class="cn">F</span>, show_column_names <span class="op">=</span> <span class="cn">F</span>, use_raster <span class="op">=</span> <span class="cn">TRUE</span>, show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span>plotlist <span class="op">=</span> <span class="va">pl</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="flip-and-reverse">Flip and reverse<a class="anchor" aria-label="anchor" href="#flip-and-reverse"></a>
</h2>
<p>The design of the diagram is to let all forms of the curve can be expanded only by rotation, i.e. without leaving the plate (flipping) or modify the sequence (reverse). However, we can define the flipping horizontal, vertical and by the diagonal.</p>
<p>Flippping the base pattern can be easily obtained, here we only focused on a sequence of patterns. Observing the diagram, in the expandiong step, only the three base pattersn of <span class="math inline">\(I\)</span>, <span class="math inline">\(L\)</span> and <span class="math inline">\(R\)</span> are used. Thus in the following, we only restructed the notation <span class="math inline">\(X\)</span> to the set <span class="math inline">\(\{I, L, R\}\)</span>.</p>
<div class="section level3">
<h3 id="horizontal-flip">Horizontal flip<a class="anchor" aria-label="anchor" href="#horizontal-flip"></a>
</h3>
<p>We first calculate the horizontal flipping of a single base pattern:</p>
<p><span class="math display">\[ 
\begin{align*}
\mathrm{Flip}_\mathrm{h}(I^\alpha) &amp;= I^\alpha, &amp; \alpha \in \{0, 180\}, \\
\mathrm{Flip}_\mathrm{h}(I^\beta) &amp;= I^{\beta + 180}, &amp; \beta \in \{90, 270\}, \\
\mathrm{Flip}_\mathrm{h}(R^\alpha) &amp;= L^\alpha, &amp; \alpha \in \{0, 180\}, \\
\mathrm{Flip}_\mathrm{h}(R^\beta) &amp;= L^{\beta + 180}, &amp; \beta \in \{90, 270\}, \\
\mathrm{Flip}_\mathrm{h}(L^\alpha) &amp;= R^\alpha, &amp; \alpha \in \{0, 180\}, \\
\mathrm{Flip}_\mathrm{h}(L^\beta) &amp;= R^{\beta + 180}, &amp; \beta \in \{90, 270\}. \\
\end{align*}
\]</span></p>
<p>Then flipping a sequence of base patterns is a sequencing of individual flipping base patterns:</p>
<p><span class="math display">\[
\mathrm{Flip}_\mathrm{h}(X_1 X_2 ...) = \mathrm{Flip}_\mathrm{h}(X_1)\mathrm{Flip}_\mathrm{h}(X_2)...
\]</span></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-23-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="vertical-flip">Vertical flip<a class="anchor" aria-label="anchor" href="#vertical-flip"></a>
</h3>
<p>Vertical flipping can be constructed in the similar way as horizontal flipping, or it can be simply constructed by first rotating the pattern <span class="math inline">\(180^\circ\)</span> then horizontal flipping:</p>
<p><span class="math display">\[
\begin{align*}
\mathrm{Flip}_\mathrm{v}(X^\theta) &amp;= \mathrm{Flip}_\mathrm{h}((X^\theta)^{180}) \\
     &amp;= \mathrm{Flip}_\mathrm{h}(X^{\theta+180})
\end{align*}
\]</span></p>
<p>Rotation and horizontal flip can be swtiched:</p>
<p><span class="math display">\[
\begin{align*}
\mathrm{Flip}_\mathrm{v}(X^\theta) &amp;= (\mathrm{Flip}_\mathrm{h}(X^\theta))^{180}
\end{align*}
\]</span></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">180</span><span class="op">)</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="fl">180</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-24-1.png" width="768" style="display: block; margin: auto;"></p>
<p>it is easy to seee</p>
<p><span class="math display">\[
\begin{align*}
\mathrm{Flip}_\mathrm{h}(\mathrm{Flip}_\mathrm{h}(X)) &amp;= \mathrm{Flip}_\mathrm{v}(\mathrm{Flip}_\mathrm{v}(X)) = X \\
\mathrm{Flip}_\mathrm{v}(\mathrm{Flip}_\mathrm{h}(X)) &amp;= \mathrm{Flip}_\mathrm{h}(\mathrm{Flip}_\mathrm{v}(X)) = X^{180}
\end{align*}
\]</span></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-25-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">180</span><span class="op">)</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-25-2.png" width="576" style="display: block; margin: auto;"></p>
<p>Vertical flipping can also be expanded to individual base patterns:</p>
<p><span class="math display">\[
\mathrm{Flip}_\mathrm{v}(X_1 X_2 ...) = \mathrm{Flip}_\mathrm{v}(X_1)\mathrm{Flip}_\mathrm{v}(X_2)...
\]</span></p>
</div>
<div class="section level3">
<h3 id="diagonal-flipping">Diagonal flipping<a class="anchor" aria-label="anchor" href="#diagonal-flipping"></a>
</h3>
<p>There are two types of diagonal flippig: against the diagonal with slop of 1 (bottomleft - topright) and -1 (topleft - bottomright).</p>
<p><span class="math display">\[
\begin{align*}
\mathrm{Flip}_\mathrm{d}^1(X^\theta) &amp;= \mathrm{Flip}_\mathrm{h}(X^{\theta - 90}) = \mathrm{Flip}_\mathrm{v}(X^{\theta + 90}) \\
\mathrm{Flip}_\mathrm{d}^{-1}(X^\theta) &amp;= \mathrm{Flip}_\mathrm{h}(X^{\theta + 90}) = \mathrm{Flip}_\mathrm{v}(X^{\theta - 90})
\end{align*}
\]</span></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-26-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-26-2.png" width="768" style="display: block; margin: auto;"></p>
<p>Also</p>
<p><span class="math display">\[
\mathrm{Flip}_\mathrm{d}^1(\mathrm{Flip}_\mathrm{d}^{1}(X)) = \mathrm{Flip}_\mathrm{d}^{-1}(\mathrm{Flip}_\mathrm{d}^{-1}(X)) = X
\]</span></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-27-1.png" width="576" style="display: block; margin: auto;"></p>
<p>and</p>
<p><span class="math display">\[
\mathrm{Flip}_\mathrm{d}^{-1}(\mathrm{Flip}_\mathrm{d}^{1}(X)) = \mathrm{Flip}_\mathrm{d}^{1}(\mathrm{Flip}_\mathrm{d}^{-1}(X)) = X^{180}
\]</span></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">180</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-28-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Diagonal flipping can also be expanded to individual base patterns: <span class="math display">\[
\mathrm{Flip}_\mathrm{d}(X_1 X_2 ...) = \mathrm{Flip}_\mathrm{d}(X_1)\mathrm{Flip}_\mathrm{d}(X_2)...
\]</span></p>
</div>
<div class="section level3">
<h3 id="reverse">Reverse<a class="anchor" aria-label="anchor" href="#reverse"></a>
</h3>
<p>Globally, the complete sequence is reversed, also individual patterns are also adjusted.</p>
<p><span class="math display">\[
\mathrm{Rev}(X_1 X_2 ... X_n) = (X'_n ... X'_2 X'_1)
\]</span></p>
<p>where</p>
<p><span class="math display">\[
X'_i = \left\{\begin{matrix}
I^{\theta_i + 180} &amp; \text{if } X_i = I^{\theta_i},\\ 
L^{\theta_i - 90} &amp; \text{if } X_i = R^{\theta_i},\\ 
R^{\theta_i + 90} &amp; \text{if } X_i = L^{\theta_i}.\\ 
\end{matrix}\right. i \in \{1, ..., n\}
\]</span></p>
<p>If flipping and reverse are also supported, the patterns at level = 1 can be represented by each other, e.g.</p>
<p><span class="math display">\[
\begin{align*}
I^{(1)}_2 &amp;= \mathrm{Flip}_\mathrm{h}(I^{(1)}_1) \\
L^{(1)}_2 &amp;= \mathrm{Flip}_\mathrm{h}(R^{(1)}_1) \\
L^{(1)}_1 &amp;= \mathrm{Rev}((R^{(1)}_1)^{90}) \\
R^{(1)}_2 &amp;= \mathrm{Rev}(\mathrm{Flip}_\mathrm{d}^{-1}(R^{(1)}_1))
\end{align*}
\]</span></p>
<p>As you can see, flippping and reversing increase the complexity of interpretation, thus we considered both flip and xxx and only allows rotation when expanding the curve.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  <style>nav[data-toggle='toc'] .nav .nav {display: block;}</style>
</body>
</html>
