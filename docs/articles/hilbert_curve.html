<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sfcurve">
<title>Generalized Hilbert Curve • sfcurve</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Hilbert Curve">
<meta property="og:description" content="sfcurve">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sfcurve</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hilbert_curve.html">1. Generalized Hilbert Curve</a>
    <a class="dropdown-item" href="../articles/peano_curve.html">2. Generalized Peano Curve</a>
    <a class="dropdown-item" href="../articles/meander_curve.html">3. Generalized Meander Curve</a>
    <a class="dropdown-item" href="../articles/unit_flipping.html">4. Unit flipping</a>
    <a class="dropdown-item" href="../articles/standard_curves.html">5. Standard curves</a>
    <a class="dropdown-item" href="../articles/all_3x3_curve.html">6. 3x3 Curve</a>
    <a class="dropdown-item" href="../articles/meander_4x4_curve.html">7. 4x4 Meander Curve</a>
    <a class="dropdown-item" href="../articles/nxn_curve.html">8. General nxn Curves</a>
    <a class="dropdown-item" href="../articles/h_curve.html">9. H-Curve</a>
    <a class="dropdown-item" href="../articles/hilbert_3d.html">10. 3D Hilbert curve</a>
    <a class="dropdown-item" href="../articles/locality.html">11. Locality of various curves</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/functions.html">Functions/Classes</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jokergoo/sfcurve/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Generalized Hilbert Curve</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 data-toc-skip class="date">2024-08-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/sfcurve/blob/HEAD/vignettes/hilbert_curve.Rmd" class="external-link"><code>vignettes/hilbert_curve.Rmd</code></a></small>
      <div class="d-none name"><code>hilbert_curve.Rmd</code></div>
    </div>

    
    
<p>We consider the type of space-filling curve that has a 2x2 growth rate. The growth of the curve can be described in a top-bottom manner, where within a square with fixed size (normally a unit square), the square is partitioned into four sub-squares by equally splitting it into two halves both horizontally and vertically. Then on each sub-square, such partitioning is applied recursively. It can also be described in a bottom-top manner, where with a unit square expands into four squares by duplicating itself both on rows and columns, then each of the four squares expands itself recursively. It is easy to see, the two ways are identical only with a size factor <span class="math inline">\(n\)</span> (the edge of the square) or <span class="math inline">\(n^2\)</span> (the area).</p>
<p>For easy discussion, we use the expansion mode. When expanding one square to four squares (2x2), there are several ways, such as the z-curve or H-curve. Here we require the curve only goes straight, left or right along the four squares without interuptted or crossed.</p>
<p>The following three plots demonstrate the three steps of the expansion which are <span class="math inline">\(2^0 \times 2^0\)</span> (level 0), <span class="math inline">\(2^1 \times 2^1\)</span> (level 1) and <span class="math inline">\(2^2 \times 2^2\)</span> (level 2).</p>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-2-1.png" width="460.8" style="display: block; margin: auto;"></p>
<div class="section level2">
<h2 id="base-patterns">Base patterns<a class="anchor" aria-label="anchor" href="#base-patterns"></a>
</h2>
<p>The space-filling curve can be generated by recursively repeating certain patterns on its sub-structures. Thus, we define the following expansion rules from level 0 to level 1. The patterns on level 0 are called the <strong>base patterns</strong> which contains a single points and its in-direction and out-direction.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_rules.html">draw_rules_hilbert</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>For example, base pattern <span class="math inline">\(I\)</span> is on level 0, explicitly denoted as <span class="math inline">\(I^{(0)}\)</span>. When it expands to level 1 while keeping the direction of the curve, there are two options as listed in the diagram. As an example here, we choose the first option. Now for the following expansion:</p>
<p><span class="math display">\[
I^{(0)} \rightarrow I^{(1)}_1
\]</span></p>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-4-1.png" width="124.8" style="display: block; margin: auto;"></p>
<p>we can describe the curve generation in four steps:</p>
<ul>
<li>step 1. bottom in, right out. This is the base pattern <span class="math inline">\(R\)</span> without rotation, thus we denote it as <span class="math inline">\(R^{(0)}\)</span>,</li>
<li>step 2. left in, top out. This is the base pattern <span class="math inline">\(L\)</span> with -90 degrees clockwise rotation, thus we denote it as <span class="math inline">\(L^{(0),-90}\)</span> or <span class="math inline">\(L^{(0),270}\)</span>,</li>
<li>step 3. bottom in, left out. This is the base pattern <span class="math inline">\(L\)</span> without rotation, and we denote it as <span class="math inline">\(L^{(0)}\)</span>,</li>
<li>step 4. right in, top out. This step can be denoted as <span class="math inline">\(R^{(0),90}\)</span>.</li>
</ul>
<p>Then the expansion can be written as a sequence of four base patterns:</p>
<p><span class="math display">\[
I^{(1)}_1 = R^{(0)}L^{(0),90}L^{(0)}R^{(0),270}
\]</span></p>
<p>With knowing the in-direction and out-direction of base patterns, the shape of <span class="math inline">\(I^{(1)}_1\)</span> can be determined. In the diagram, the notation of levels are removed since it can be easily identified.</p>
<p><span class="math display">\[
I_1 = RL^{90}LR^{270}
\]</span></p>
<p>The base pattern defines the out-direction which determines the location of the next point, thus, as long as the “actions” of the base patterns in a sequence is known (i.e. going left or right), the form of the sequence is fixed. In other words, only the rotation of the first base pattern determines the final form of the sequence and once it is fixed, the rotations of the remaining base patterns are all fixed and they can be automatically calculated. However we still explicitly add the rotations to all base patterns (except those with rotations of zero) since we also need to deal with segments of curves in the package.</p>
<p>In later sections or other vignettes, we sometimes also call base patterns to <strong>base letters</strong> for convinience.</p>
</div>
<div class="section level2">
<h2 id="rotate">Rotate<a class="anchor" aria-label="anchor" href="#rotate"></a>
</h2>
<p>We set the rotation of all base patterns with the shapes listed in the diagram to zero (i.e. the <strong>base state</strong>. Of course it is only for convinience). We can easily define the rotation of a base pattern or a sequence of base patterns.</p>
<p>Denote <span class="math inline">\(X^\theta\)</span> as a base pattern where <span class="math inline">\(X \in \{I, R, L, U, B, D, P, Q, C\}\)</span>, and <span class="math inline">\(\theta\)</span> is the rotation regarding to the base state in the diagram, <span class="math inline">\(\theta \in \{0, 90, 180, 270\}\)</span> and a positive <span class="math inline">\(\theta\)</span> corresponds to reverse clockwise rotation, we have</p>
<p><span class="math display">\[ (X^{\theta_1})^{\theta_2} = X^{\theta_1 + \theta_2} \]</span></p>
<p>which means rotating the pattern twice is identical to rotating the pattern once but with the sum of the two rotations.</p>
<p>Note</p>
<p><span class="math display">\[
X^\theta = X^{\theta \bmod 360}
\]</span></p>
<p>Rotating a sequence of base patterns is identical to rotating individual base patterns in a sequence.</p>
<p><span class="math display">\[
(X_1^{\theta_1}X_2^{\theta_2}...X_n^{\theta_n})^\theta  = X_1^{(\theta_1 + \theta)}X_2^{(\theta_2 + \theta)} ... X_n^{(\theta_n + \theta)}
\]</span></p>
<p>By also including all four rotations of the base patterns, the diagram contains the complete set of expansions from level 0 to level 1 for the 2x2 curve.</p>
</div>
<div class="section level2">
<h2 id="expand-the-curve">Expand the curve<a class="anchor" aria-label="anchor" href="#expand-the-curve"></a>
</h2>
<p>The diagram only defines the expansion of the curve from level 0 to level 1 (the 0-to-1 expansion), but that is already enough for generating a curve to level k. For simplicity, we take a curve initialized by a single base pattern as an example. The expansion process can be described as in the following steps:</p>
<ol style="list-style-type: decimal">
<li>level 0 -&gt; level 1, <span class="math inline">\(P_1 = (X_i)_4\)</span>. This generates a level 1 curve with 4 base patterns.</li>
<li>level 1 -&gt; level 2, <span class="math inline">\(P_2 = (X_i)_{16}\)</span>. For each base pattern in <span class="math inline">\(P_1\)</span>, we replace it with its level 1 expansion. This generates a curve with <span class="math inline">\(4^2\)</span> base patterns.</li>
<li>level k-1 -&gt; level k, <span class="math inline">\(P_k = (X_i)_{4^k}\)</span>. Note the curve on level k-1 <span class="math inline">\(P_{k-1}\)</span> is already represented as a sequence of <span class="math inline">\(4^{k-1}\)</span> base patterns. Then for each base pattern in <span class="math inline">\(P_{k-1}\)</span>, we replace it with its level 1 expansion. This generates a curve with <span class="math inline">\(4^k\)</span> base patterns.</li>
</ol>
<p>where <span class="math inline">\(P_i\)</span> is the curve or unit on level i. We can see, to expand a curve to level k step by step, we only need to use the expansions from level 0 to level 1.</p>
<p>One problem arises when expanding a base pattern to its level unit. As shown in the diagram, in the expansion from level 0 to level 1, each base pattern has two types of expansion, thus we need a criterion to select the proper one to make sure all the points are correctedly connected on the final curve.</p>
<p>In the first step where a single base pattern expands to four base patterns, the level 1 unit can be ensured to be connected. However, in the second step where four base patterns expand to 16 base patterns, i.e. from level 1 to level 2, we need to make sure the 16 base patterns are connected in the corrected way, i.e. straight, left and right.</p>
<p>Let’s rewrite <span class="math inline">\(P_1\)</span> as a sequence of four base patterns:</p>
<p><span class="math display">\[
P_1 = X_1 X_2 X_3 X_4
\]</span></p>
<p>When e.g. the base pattern <span class="math inline">\(X_1\)</span> expands to level 1 denoted as <span class="math inline">\(X^{(1)}_{&lt;i&gt;,1}\)</span> (<span class="math inline">\(i=1\)</span> or <span class="math inline">\(i=2\)</span>), then <span class="math inline">\(P_2\)</span> is:</p>
<p><span class="math display">\[
P_2 = X^{(1)}_{&lt;i_1&gt;,1} X^{(1)}_{&lt;i_2&gt;,2} X^{(1)}_{&lt;i_3&gt;,3} X^{(1)}_{&lt;i_4&gt;,4}
\]</span></p>
<p>The four <span class="math inline">\(X^{(1)}_{&lt;i&gt;,1}\)</span> represents as four 2x2 grids. We need a criterion for selecting <span class="math inline">\(i\)</span> for each level 1 unit to make sure all the level 1 units on the curve are properly connected.</p>
<p>A curve on level k contains <span class="math inline">\(4^{k-1}\)</span> 2x2 units expanded from the curve on level k-1. Thus, the successful method can ensure all the <span class="math inline">\(4^{k-1}\)</span> 2x2 units are properly connected and makes the final curve in the correct form.</p>
<div class="section level3">
<h3 id="corners">Corners<a class="anchor" aria-label="anchor" href="#corners"></a>
</h3>
<p>All the level 1 units transverse through a <span class="math inline">\(2 \times 2\)</span> grids, thus they all have a square-shape with an in-direction and an out-direction. Denote the bottom left and top right have a value of 1 and the top left and bottom right have a value of 2:</p>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-5-1.png" width="192" style="display: block; margin: auto;"></p>
<p>We define the <strong>corner value</strong> <span class="math inline">\(\tau\)</span> of the level 1 unit <span class="math inline">\(X^{(1)}\)</span> as a 2-tuple <span class="math inline">\((c_1, c_2)\)</span> where <span class="math inline">\(c_1\)</span> is the value of the entering corner and <span class="math inline">\(c_2\)</span> is the value of the leaving corner of <span class="math inline">\(X^{(1)}\)</span>:</p>
<p><span class="math display">\[
\tau_{X^{(1)}} = (c_1, c_2), \quad c_1, c_2 \in \{1, 2\}
\]</span></p>
<p>In the diagram, for all the 2x2 unit defined there, either <span class="math inline">\(\tau_{X^{(1)}} = (1, 2)\)</span> or <span class="math inline">\(\tau_{X^{(1)}} = (2, 1)\)</span>. We define the complement of <span class="math inline">\(c\)</span> as</p>
<p><span class="math display">\[
\hat{c} = \left\{\begin{matrix}
2 &amp; \text{if }c = 1,\\ 
1 &amp; \text{if }c = 2,\\ 
\end{matrix}\right.
\]</span></p>
<p>Rotating <span class="math inline">\(X^{(1)}\)</span> by 90 degrees (or its multiples, either clockwise or reverse clockwise) changes the order of the two values in the tuple, while rotating by 180 degrees (or its multiples) does not.</p>
<p><span class="math display">\[
\begin{align*}
\tau_{X^{(1), 90k}} &amp;= (c_1, c_2) &amp; \text{if }k\text{ is even}, \\
\tau_{X^{(1), 90k}} &amp;= (\hat{c}_1, \hat{c}_2) &amp; \text{if }k\text{ is odd}, \\
\end{align*}
\]</span></p>
<p>Let’s go back to the diagram. For each base pattern, there are two level 1 units that can be expanded to. We code the two level 1 units according to their corner values as follows for convinience:</p>
<p><span class="math display">\[
\begin{align*}
X_{&lt;1&gt;}^{(1)} \quad \text{if }\tau_{X^{(1)}} &amp;= (1, 2), \\
X_{&lt;2&gt;}^{(1)} \quad \text{if }\tau_{X^{(1)}} &amp;= (2, 1). \\
\end{align*}
\]</span></p>
<p><span class="math inline">\(&lt;1&gt;\)</span> and <span class="math inline">\(&lt;2&gt;\)</span> are called the <strong>expansion code</strong> of base pattern <span class="math inline">\(X\)</span>.</p>
</div>
<div class="section level3">
<h3 id="connect-patterns">Connect patterns<a class="anchor" aria-label="anchor" href="#connect-patterns"></a>
</h3>
<p>For two level 1 units <span class="math inline">\(X^{(1)}\)</span> and <span class="math inline">\(Y^{(1)}\)</span> with corners <span class="math inline">\((c_1, c_2)\)</span> and <span class="math inline">\((c_3, c_4)\)</span> (of course <span class="math inline">\(c_2 = \hat{c_1}\)</span>, <span class="math inline">\(c_4 = \hat{c_3}\)</span>), to construct the sequence <span class="math inline">\(XY\)</span>, we need to ensure the two units are connectable. Since the two units represented as two square patterns can only be connected horizontally or vertically, it should fit <span class="math inline">\(c_2 = \hat{c_3}\)</span>, i.e. with the forms of <span class="math inline">\(\tau_{X^{(1)}} = (1, 2), \tau_{y^{(1)}} = (1,2)\)</span> or <span class="math inline">\(\tau_{X^{(1)}} = (2, 1), \tau_{y^{(1)}} = (2,1)\)</span>. It is easy to see, we can apply it to a sequence with any length. For for short, the corner values of all base patterns in the sequence should be the same.</p>
<p>Next Let’s extend it to base patterns with rotations. Denote two level 1 units <span class="math inline">\(X^{(1),\alpha} Y^{(1),\beta}\)</span>, we first assign an expansion code <span class="math inline">\(i\)</span> to the first unit, say <span class="math inline">\(X_{&lt;i&gt;}^{(1),\alpha}\)</span> (<span class="math inline">\(i \in \{1,2\}\)</span>), and we define the complement expansion code <span class="math inline">\(j\)</span> as:</p>
<p><span class="math display">\[
j = \left\{\begin{matrix}
1 &amp; \text{if }i = 2,\\ 
2 &amp; \text{if }i = 1.\\ 
\end{matrix}\right.
\]</span></p>
<p>then the expansion code for <span class="math inline">\(Y^{(1),\beta}\)</span> is determined by <span class="math inline">\(k = (\beta - \alpha)/90\)</span>:</p>
<p><span class="math display">\[
\left\{\begin{matrix}
Y^{(1),\beta}_{&lt;i&gt;}, &amp; \text{if }k\text{ is even}, \\
Y^{(1),\beta}_{&lt;j&gt;}, &amp; \text{if }k\text{ is odd}. \\
\end{matrix}\right.
\]</span></p>
<p>which means if <span class="math inline">\(\beta-\alpha\)</span> is the even multiples of 90 degrees, <span class="math inline">\(Y^{(1),\beta}\)</span> has the same expansion code as <span class="math inline">\(X^{(1),\alpha}\)</span>; if <span class="math inline">\(\beta-\alpha\)</span> is the odd multiples of 90 degrees, <span class="math inline">\(Y^{(1),\beta}\)</span> has the complement code of <span class="math inline">\(X^{(1),\alpha}\)</span>.</p>
<p>so for example, starting from <span class="math inline">\(I^{90}\)</span>, to extend it, we choose <span class="math inline">\(I_1^{90}\)</span> with the level 1 form</p>
<p><span class="math display">\[
P_1 = I_1^{90} = (RL^{90}LR^{270})^{90} = R^{90}L^{180}L^{90}R
\]</span></p>
<p>To extend to level 2, we have to assign the expansion code to each of the <span class="math inline">\(RLRL\)</span>. We start from the first pattern <span class="math inline">\(R\)</span>, as there are two options, we use <span class="math inline">\(R_1\)</span> (here we write <span class="math inline">\(R_{&lt;1&gt;}^{(1)}\)</span> as <span class="math inline">\(R_1\)</span> for simplicity), then according to the rules defined befoe, we can assign the expansion codes to the four base patterns:</p>
<p><span class="math display">\[
P_2 = R_1^{90}L_2^{180}L_1^{90}R_2
\]</span></p>
<p>then by extending to level 0, we can obtain the final sequence of base patterns for a level 2 curve:</p>
<p><span class="math display">\[
\begin{align*}
P_2 &amp;= (IRR^{90}L^{180})^{90}(ILL^{270}R^{180})^{180}(RL^{90}LI^{270})^{90}(LR^{270}RI^{90}) \\
    &amp;= I^{90}R^{90}R^{180}L^{270}I^{180}L^{180}L^{90}RR^{90}L^{180}L^{90}ILR^{270}RI^{90} \\
\end{align*}
\]</span></p>
<p>By the way, the rotations from the second base pattern in the sequence can be automatically calculated from the first base pattern.</p>
<p>When expanding a curve from level k-1 to level k, on level k-1, we only need to pre-select the transverse code for the first base pattern, then the transverse code for the remainingbase patterns on level k-1 is determined, which ensures the expanded <span class="math inline">\(4^{k-1}\)</span> 2x2 units are all connected.</p>
<p>Finally, the sequence of the transverse code for each base unit in the expansion is called the <strong>transverse path</strong>. E.g. the two different transverse paths of the <span class="math inline">\(R_1\)</span> 2x2 unit, determined by the expansion code of the first base pattern:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/transverse_path.html">plot_transverse_paths</a></span><span class="op">(</span><span class="va">SFC_RULES_HILBERT</span>, <span class="va">SFC_RULES_HILBERT</span><span class="op">@</span><span class="va">rules</span><span class="op">$</span><span class="va">R</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
<p>The two transverse paths can be written as:</p>
<p><span class="math display">\[
\begin{align*}
\mathcal{p}_1 &amp;= (1, 1, 2, 1) \\
\mathcal{p}_2 &amp;= (2, 2, 1, 2) \\
\end{align*}
\]</span></p>
</div>
</div>
<div class="section level2">
<h2 id="encode-the-curve">Encode the curve<a class="anchor" aria-label="anchor" href="#encode-the-curve"></a>
</h2>
<p>Let’s start from a single base pattern as the initial seed. As has been explained, on each level of expansion, an expansion code should be selected for the first base pattern to determine the transverse path of the whole sequence. Then the possible expansions from a single base pattern can be described in the following diagram.</p>
<p><img src="hc_expand.png" width="100%" style="display: block; margin: auto;"></p>
<p>So, on level k, the total number of different forms of the 2x2 curve are <span class="math inline">\(2^k\)</span> because on each level there are two transverse paths to select. Taking <span class="math inline">\(R\)</span> as the initial seed, the size of the full set of level-3 curves are 8:</p>
<p>Note the orientation of <span class="math inline">\(R\)</span> is bottom in and right out.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="st">"111"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="st">"112"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="st">"121"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="st">"122"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="st">"211"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="st">"212"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="st">"221"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="st">"222"</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">2</span>, title <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Then, with knowing the intial seed and the expansion code (the first base pattern) on each step, the curve is fully determined. Then we can describe a <span class="math inline">\(2^k \times 2^k\)</span> curve denoted as <span class="math inline">\(\mathcal{C}_k\)</span> as:</p>
<p><span class="math display">\[
\mathcal{C}_k := X^{(0),\theta}|\pi_1 \pi_2 ... \pi_k \quad \pi_i \in \{1, 2\},\theta \in \{0,90,180,270\}
\]</span></p>
<p>where in the expansion code sequence, if the code is more to the left, it corresponds more to the top-level of the curve, and if the code is more to the right of the sequence, it corresponds more to the bottom-level of the curve.</p>
<p>Note the sequence <span class="math inline">\((\pi_1 \pi_2, ..., \pi_k)\)</span> can be represented as a sequence of binary bits, so the sequence of the expansion code on each level can also be described as an integer:</p>
<p><span class="math display">\[
X|111 = X|0_3 \\
X|121 = X|2_3 \\
X|222 = X|7_3
\]</span></p>
<p>A specific base pattern can induce <span class="math inline">\(2^k\)</span> different forms of curves on level <span class="math inline">\(k\)</span>, so the total number of the forms for all 9 base patterns with 4 rotations are</p>
<p><span class="math display">\[
4 \times 9 \times 2^k = 36 \times 2^k
\]</span></p>
<div class="section level3">
<h3 id="specific-forms">Specific forms<a class="anchor" aria-label="anchor" href="#specific-forms"></a>
</h3>
<p>The Hilbert curve, the Moore curve and the <span class="math inline">\(\beta-\Omega\)</span> curve are just special forms of the 2x2 curve. They have special expansion code sequences and seed base patterns.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"I"</span>, code <span class="op">=</span>  <span class="st">"111"</span>, rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"U"</span>, code <span class="op">=</span>  <span class="st">"211"</span>, rot <span class="op">=</span> <span class="fl">180</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"C"</span>, code <span class="op">=</span> <span class="st">"2121"</span>, rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>,</span>
<span>  title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Hilbert"</span>, <span class="st">"Moore"</span>, <span class="st">"Beta-Omega"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
<p>In the sequence of type code on levels:</p>
<p><span class="math display">\[
\pi_1, \pi_2, ..., \pi_{k-1}, \pi_{k}
\]</span></p>
<p>particularlly, the last two type codes which construct the unit of 4x4 is the most observable unit in the curve. If we define the following shape as the basic units of Hilbert curve, i.e. the Hilbert units:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"11"</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"22"</span><span class="op">)</span>, </span>
<span>    extend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-10-1.png" width="384" style="display: block; margin: auto;"></p>
<p>then we can define the “general Hilbert curve” <span class="math inline">\(\mathcal{H}_k\)</span> as:</p>
<p><span class="math display">\[
\mathcal{H}_k := X^{\theta}|\pi_1 \pi_2 ... \pi_{k_-1} \pi_k \quad X \in \{I, R, L, U\}, \pi_{k-1} = \pi_k
\]</span></p>
<p>We can also define the <span class="math inline">\(\beta\)</span> unit and the <span class="math inline">\(\Omega\)</span> unit as the following two:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"L"</span>, <span class="st">"21"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"12"</span>, rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-11-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The the genral “<span class="math inline">\(\beta-\Omega\)</span> curve” <span class="math inline">\(\mathcal{B}_k\)</span> (k &gt;= 3) is defined as:</p>
<p><span class="math display">\[
\mathcal{B}_k := C^{\theta}|\pi_1 \pi_2 ... \pi_{k_-1}, \pi_k \quad \pi_{k-1} \ne \pi_k
\]</span></p>
<p>Last the “general Moore curve” <span class="math inline">\(\mathcal{M}_k\)</span> is defined as:</p>
<p><span class="math display">\[
\mathcal{M}_k := U^{\theta}|\pi_1 \pi_2 ... \pi_{k_-1}, \pi_k \quad \pi_1 \ne \pi_2, \pi_2 = \pi_3 = ... = \pi_k
\]</span></p>
</div>
<div class="section level3">
<h3 id="combinations-of-the-expansion-codes">Combinations of the expansion codes<a class="anchor" aria-label="anchor" href="#combinations-of-the-expansion-codes"></a>
</h3>
<p>Let’s go back to the sequence of a curve on level k</p>
<p><span class="math display">\[
\mathcal{C}_k = X^{(0)}|\pi_1 \pi_2 ... \pi_k
\]</span></p>
<p>The equation represents the curve starting from <span class="math inline">\(X^{(0)}\)</span> and expands k times. We can merge <span class="math inline">\(X^{(0)}\)</span> and the first expansion to form a new initial seed, and expand the curve k-1 times, written as:</p>
<p><span class="math display">\[
\begin{align*}
\mathcal{C}_k &amp;= (X^{(0)}|\pi_1) | \pi_2 ... \pi_k \\
              &amp;=  X^{(1)}_{&lt;\pi_1&gt;} | \pi_2 ... \pi_k \\
\end{align*}
\]</span></p>
<p>Similarlly we can move any <span class="math inline">\(\pi_i\)</span> to the left side:</p>
<p><span class="math display">\[
\mathcal{C}_k = (X^{(0)}|\pi_1 ... \pi_i) | \pi_{(i+1)} ... \pi_k
\]</span></p>
<p>Or we move one <span class="math inline">\(\pi\)</span> per time and expand a new initial seed.</p>
<p><span class="math display">\[
\mathcal{C}_k = {[(X^{(0)}|\pi_1)| \pi_2] | ...}| \pi_k
\]</span></p>
<p>Simply written as:</p>
<p><span class="math display">\[
\mathcal{C}_k = X^{(0)}|\pi_1 | \pi_2 | ... | \pi_k
\]</span></p>
<p>The following example corresponds to the sequence <span class="math inline">\(R|1212\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial</span> <span class="op">=</span> <span class="fu"><a href="../reference/sfc_sequence.html">sfc_seed</a></span><span class="op">(</span><span class="st">"R"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1212"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1"</span><span class="op">)</span>, <span class="st">"212"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"12"</span><span class="op">)</span>, <span class="st">"12"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"121"</span><span class="op">)</span>, <span class="st">"2"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1212"</span><span class="op">)</span>, <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1"</span><span class="op">)</span>, <span class="st">"2"</span><span class="op">)</span>, <span class="st">"1"</span><span class="op">)</span>, <span class="st">"2"</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-12-1.png" width="1152" style="display: block; margin: auto;"></p>
<p>we can merge or group neighbouring expansions to form a new expansion rule, e.g.</p>
<p><span class="math display">\[
\mathcal{C}_k = X^{(0)}| \pi_1 \pi_2 | \pi_3 \pi_4 | ... | \pi_{k-1} \pi_k
\]</span></p>
<p>This means, instead of doing a 2x2 expansion, now we can do a 4x4 expansion, and each expansion mode is determined by <span class="math inline">\(\pi_{i-1} \pi_i\)</span>. Let’s define a new expansion <span class="math inline">\(\lambda\)</span> which is a group of two 2x2 expansions:</p>
<p><span class="math display">\[
\begin{align*}
\lambda &amp;= \pi \pi' \\
\lambda &amp;= \left\{\begin{matrix}
1,&amp; \pi \pi' = 1 1 \\
2,&amp; \pi \pi' = 1 2 \\
3,&amp; \pi \pi' = 2 1 \\
4,&amp; \pi \pi' = 2 2 \\
\end{matrix}\right.
\end{align*}
\]</span></p>
<p>In this case, the 4x4 expansion has four expansion code <code>1/2/3/4</code>. And the 4x4 expansion is identical to the 2x2 expansion:</p>
<p><span class="math display">\[
X|\lambda_1 \lambda_2 ... = X|\pi_1\pi_1' \pi_2 \pi_2' ...
\]</span></p>
<p>Next examples show the level 0-3 of the 4x4 expansions:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span><span class="op">)</span></span>
<span><span class="va">sfc_4x4</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">initial</span>, <span class="va">code</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">map</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"11"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"12"</span>, <span class="st">"3"</span> <span class="op">=</span> <span class="st">"21"</span>, <span class="st">"4"</span> <span class="op">=</span> <span class="st">"22"</span><span class="op">)</span></span>
<span>    <span class="va">code</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">code</span>, <span class="st">""</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">code2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">map</span><span class="op">[</span><span class="va">code</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">initial</span>, <span class="va">code2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">initial</span>, <span class="fu">grob</span><span class="op">(</span><span class="op">)</span>, <span class="fu">grob</span><span class="op">(</span><span class="op">)</span>, <span class="fu">grob</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"1"</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"2"</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"3"</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"4"</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"11"</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"12"</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"23"</span><span class="op">)</span>,</span>
<span>    <span class="fu">sfc_4x4</span><span class="op">(</span><span class="va">initial</span>, <span class="st">"34"</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-13-1.png" width="864" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="seed-as-a-sequence">Seed as a sequence<a class="anchor" aria-label="anchor" href="#seed-as-a-sequence"></a>
</h2>
<p>We have demonstrated <span class="math inline">\(X\)</span> as a single base pattern. Actually there is no restriction of the length of the seed sequence. The seed sequence determines the global structure of the final curve.</p>
<p>In the following example, the global structure is <span class="math inline">\(I^{90}RL\)</span>, horizonal staring from left, go straight, then turn right and turn left. We can expand it in the normal way.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"IRL"</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-14-1.png" width="384" style="display: block; margin: auto;"></p>
<p>A spiral seed sequence:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sfc_sequence.html">sfc_seed</a></span><span class="op">(</span><span class="st">"LLLILILIILIILIIILIIILIIII"</span>, universe <span class="op">=</span> <span class="fu"><a href="../reference/sfc_universe.html">sfc_universe</a></span><span class="op">(</span><span class="va">SFC_RULES_HILBERT</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span>, grid <span class="op">=</span> <span class="cn">TRUE</span>, extend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-15-1.png" width="192" style="display: block; margin: auto;"></p>
<p>Expand the spiral with 2x2 curves:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="va">p</span>, code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-16-1.png" width="480" style="display: block; margin: auto;"></p>
<p>Note for the base patterns not in <code>I/L/R</code>, when constructing a complex initial pattern sequence, <span class="math inline">\(U\)</span> can only be used in form <span class="math inline">\((UU^{180})^\theta\)</span>, <span class="math inline">\(C\)</span> is self-closed and cannot be connected to other base patterns, <span class="math inline">\(B\)</span>, <span class="math inline">\(D\)</span>, <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span> are half-closed and can only be used as the start or end pattern of a sequence.</p>
<p>Note the initiali squence can only be consturcted by “straight”, “lef” and “right”. Crossing is not allowed.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"IIIIIIIIII"</span>, code <span class="op">=</span> <span class="st">"11111"</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-17-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="partial-curve">Partial curve<a class="anchor" aria-label="anchor" href="#partial-curve"></a>
</h2>
<p>A curve is essentially a sequence which can be subsetted:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="st">"11111"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 1024</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p</span><span class="op">[</span><span class="fl">200</span><span class="op">:</span><span class="fl">400</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-18-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">[</span><span class="fl">200</span><span class="op">:</span><span class="fl">400</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## A sequence of 201 base patterns.</span></span>
<span><span class="co">##   R(270)R(180)L(90)L(180)  I(270)L(270)R(0)R(270)</span></span>
<span><span class="co">##   I(180)R(180)L(90)L(180)  R(270)I(180)R(180)R(90)</span></span>
<span><span class="co">##   .... other 22 lines ....</span></span>
<span><span class="co">##   R(90)R(0)L(270)L(0)      I(90)L(90)R(180)R(90)</span></span>
<span><span class="co">##   I(0)</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span><span class="op">[</span><span class="fl">200</span><span class="op">:</span><span class="fl">400</span>, <span class="cn">FALSE</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## A sequence of 201 base patterns.</span></span>
<span><span class="co">##   R(270)R(180)L(90)L(180)  I(270)L(270)R(0)R(270)</span></span>
<span><span class="co">##   I(180)R(180)L(90)L(180)  R(270)I(180)R(180)R(90)</span></span>
<span><span class="co">##   .... other 22 lines ....</span></span>
<span><span class="co">##   R(90)R(0)L(270)L(0)      I(90)L(90)R(180)R(90)</span></span>
<span><span class="co">##   I(0)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="flip-and-reverse">Flip and reverse<a class="anchor" aria-label="anchor" href="#flip-and-reverse"></a>
</h2>
<p>The design of the diagram is to let all forms of the curve can be expanded only by rotation, i.e. without leaving the plate (flipping) or modify the sequence (reverse). However, we can define the flipping horizontal, vertical and by the diagonal.</p>
<p>Flippping the base pattern can be easily obtained, here we only focused on a sequence of patterns. Observing the diagram, in the expandiong step, only the three base pattersn of <span class="math inline">\(I\)</span>, <span class="math inline">\(L\)</span> and <span class="math inline">\(R\)</span> are used. Thus in the following, we only restructed the notation <span class="math inline">\(X\)</span> to the set <span class="math inline">\(\{I, L, R\}\)</span>.</p>
<div class="section level3">
<h3 id="horizontal-flip">Horizontal flip<a class="anchor" aria-label="anchor" href="#horizontal-flip"></a>
</h3>
<p>We first calculate the horizontal flipping of a single base pattern:</p>
<p><span class="math display">\[ 
\begin{align*}
\mathrm{Flip}_\mathrm{h}(I^\alpha) &amp;= I^\alpha, &amp; \alpha \in \{0, 180\}, \\
\mathrm{Flip}_\mathrm{h}(I^\beta) &amp;= I^{\beta + 180}, &amp; \beta \in \{90, 270\}, \\
\mathrm{Flip}_\mathrm{h}(R^\alpha) &amp;= L^\alpha, &amp; \alpha \in \{0, 180\}, \\
\mathrm{Flip}_\mathrm{h}(R^\beta) &amp;= L^{\beta + 180}, &amp; \beta \in \{90, 270\}, \\
\mathrm{Flip}_\mathrm{h}(L^\alpha) &amp;= R^\alpha, &amp; \alpha \in \{0, 180\}, \\
\mathrm{Flip}_\mathrm{h}(L^\beta) &amp;= R^{\beta + 180}, &amp; \beta \in \{90, 270\}. \\
\end{align*}
\]</span></p>
<p>Then flipping a sequence of base patterns is a sequencing of individual flipping base patterns:</p>
<p><span class="math display">\[
\mathrm{Flip}_\mathrm{h}(X_1 X_2 ...) = \mathrm{Flip}_\mathrm{h}(X_1)\mathrm{Flip}_\mathrm{h}(X_2)...
\]</span></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-19-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="vertical-flip">Vertical flip<a class="anchor" aria-label="anchor" href="#vertical-flip"></a>
</h3>
<p>Vertical flipping can be constructed in the similar way as horizontal flipping, or it can be simply constructed by first rotating the pattern <span class="math inline">\(180^\circ\)</span> then horizontal flipping:</p>
<p><span class="math display">\[
\begin{align*}
\mathrm{Flip}_\mathrm{v}(X^\theta) &amp;= \mathrm{Flip}_\mathrm{h}((X^\theta)^{180}) \\
     &amp;= \mathrm{Flip}_\mathrm{h}(X^{\theta+180})
\end{align*}
\]</span></p>
<p>Rotation and horizontal flip can be swtiched:</p>
<p><span class="math display">\[
\begin{align*}
\mathrm{Flip}_\mathrm{v}(X^\theta) &amp;= (\mathrm{Flip}_\mathrm{h}(X^\theta))^{180}
\end{align*}
\]</span></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">180</span><span class="op">)</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, <span class="fl">180</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-20-1.png" width="768" style="display: block; margin: auto;"></p>
<p>it is easy to seee</p>
<p><span class="math display">\[
\begin{align*}
\mathrm{Flip}_\mathrm{h}(\mathrm{Flip}_\mathrm{h}(X)) &amp;= \mathrm{Flip}_\mathrm{v}(\mathrm{Flip}_\mathrm{v}(X)) = X \\
\mathrm{Flip}_\mathrm{v}(\mathrm{Flip}_\mathrm{h}(X)) &amp;= \mathrm{Flip}_\mathrm{h}(\mathrm{Flip}_\mathrm{v}(X)) = X^{180}
\end{align*}
\]</span></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-21-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">180</span><span class="op">)</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-21-2.png" width="576" style="display: block; margin: auto;"></p>
<p>Vertical flipping can also be expanded to individual base patterns:</p>
<p><span class="math display">\[
\mathrm{Flip}_\mathrm{v}(X_1 X_2 ...) = \mathrm{Flip}_\mathrm{v}(X_1)\mathrm{Flip}_\mathrm{v}(X_2)...
\]</span></p>
</div>
<div class="section level3">
<h3 id="diagonal-flipping">Diagonal flipping<a class="anchor" aria-label="anchor" href="#diagonal-flipping"></a>
</h3>
<p>There are two types of diagonal flippig: against the diagonal with slop of 1 (bottomleft - topright) and -1 (topleft - bottomright).</p>
<p><span class="math display">\[
\begin{align*}
\mathrm{Flip}_\mathrm{d}^1(X^\theta) &amp;= \mathrm{Flip}_\mathrm{h}(X^{\theta - 90}) = \mathrm{Flip}_\mathrm{v}(X^{\theta + 90}) \\
\mathrm{Flip}_\mathrm{d}^{-1}(X^\theta) &amp;= \mathrm{Flip}_\mathrm{h}(X^{\theta + 90}) = \mathrm{Flip}_\mathrm{v}(X^{\theta - 90})
\end{align*}
\]</span></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-22-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="op">-</span><span class="fl">90</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-22-2.png" width="768" style="display: block; margin: auto;"></p>
<p>Also</p>
<p><span class="math display">\[
\mathrm{Flip}_\mathrm{d}^1(\mathrm{Flip}_\mathrm{d}^{1}(X)) = \mathrm{Flip}_\mathrm{d}^{-1}(\mathrm{Flip}_\mathrm{d}^{-1}(X)) = X
\]</span></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-23-1.png" width="576" style="display: block; margin: auto;"></p>
<p>and</p>
<p><span class="math display">\[
\mathrm{Flip}_\mathrm{d}^{-1}(\mathrm{Flip}_\mathrm{d}^{1}(X)) = \mathrm{Flip}_\mathrm{d}^{1}(\mathrm{Flip}_\mathrm{d}^{-1}(X)) = X^{180}
\]</span></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_rotate</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">180</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-24-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Diagonal flipping can also be expanded to individual base patterns: <span class="math display">\[
\mathrm{Flip}_\mathrm{d}(X_1 X_2 ...) = \mathrm{Flip}_\mathrm{d}(X_1)\mathrm{Flip}_\mathrm{d}(X_2)...
\]</span></p>
</div>
<div class="section level3">
<h3 id="reverse">Reverse<a class="anchor" aria-label="anchor" href="#reverse"></a>
</h3>
<p>Globally, the complete sequence is reversed, also individual patterns are also adjusted.</p>
<p><span class="math display">\[
\mathrm{Rev}(X_1 X_2 ... X_n) = (X'_n ... X'_2 X'_1)
\]</span></p>
<p>where</p>
<p><span class="math display">\[
X'_i = \left\{\begin{matrix}
I^{\theta_i + 180} &amp; \text{if } X_i = I^{\theta_i},\\ 
L^{\theta_i - 90} &amp; \text{if } X_i = R^{\theta_i},\\ 
R^{\theta_i + 90} &amp; \text{if } X_i = L^{\theta_i}.\\ 
\end{matrix}\right. i \in \{1, ..., n\}
\]</span></p>
<p>If flipping and reverse are also supported, the patterns at level = 1 can be represented by each other, e.g.</p>
<p><span class="math display">\[
\begin{align*}
I^{(1)}_2 &amp;= \mathrm{Flip}_\mathrm{h}(I^{(1)}_1) \\
L^{(1)}_2 &amp;= \mathrm{Flip}_\mathrm{h}(R^{(1)}_1) \\
L^{(1)}_1 &amp;= \mathrm{Rev}((R^{(1)}_1)^{90}) \\
R^{(1)}_2 &amp;= \mathrm{Rev}(\mathrm{Flip}_\mathrm{d}^{-1}(R^{(1)}_1))
\end{align*}
\]</span></p>
<p>As you can see, flippping and reversing increase the complexity of interpretation, thus we considered both flip and xxx and only allows rotation when expanding the curve.</p>
</div>
<div class="section level3">
<h3 id="local-flipping">Local flipping<a class="anchor" aria-label="anchor" href="#local-flipping"></a>
</h3>
<p>We have introduced the flipping of the whole sequence. There is another type of flipping which is like local flipping and it only flips subunits in the curve while the in-direction and out-direction of the subunits is not changed. Compare the following examples. <code><a href="../reference/spacefilling.html">sfc_meander()</a></code> and <code><a href="../reference/spacefilling.html">sfc_peano()</a></code> makes the Meander and Peano 3x3 curves which will be introduced in other vignettes.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_meander</a></span><span class="op">(</span><span class="st">"R"</span>, <span class="fl">2</span>, rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_hflip</a></span><span class="op">(</span><span class="va">p</span>, fix_ends <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-25-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_meander</a></span><span class="op">(</span><span class="st">"L"</span>, <span class="fl">2</span>, rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_vflip</a></span><span class="op">(</span><span class="va">p</span>, fix_ends <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-25-2.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_peano</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="../reference/sfc_transformation.html">sfc_dflip</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span>, fix_ends <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-25-3.png" width="768" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="visualize-curves-in-other-layouts">Visualize curves in other layouts<a class="anchor" aria-label="anchor" href="#visualize-curves-in-other-layouts"></a>
</h2>
<p>We can make e.g. circular transformation of the original coordinates:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"IIIIIIIIII"</span>, <span class="st">"11111"</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span><span class="va">loc</span> <span class="op">=</span> <span class="fu"><a href="../reference/sfc_segments.html">sfc_segments</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loc</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/circlize" class="external-link">circlize</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/circos.par.html" class="external-link">circos.par</a></span><span class="op">(</span>gap.degree <span class="op">=</span> <span class="fl">0</span>, cell.padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/circos.initialize.html" class="external-link">circos.initialize</a></span><span class="op">(</span>sectors <span class="op">=</span> <span class="st">"foo"</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">col_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>, <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">11</span>, <span class="st">"Spectral"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/circos.track.html" class="external-link">circos.track</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, panel.fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/circos.segments.html" class="external-link">circos.segments</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span>, <span class="fl">2</span><span class="op">]</span>, col <span class="op">=</span> <span class="fu">col_fun</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span>, track.height <span class="op">=</span> <span class="fl">0.5</span>, bg.border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-26-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/circlize/man/circos.clear.html" class="external-link">circos.clear</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Or in a spiral layout:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strrep.html" class="external-link">strrep</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="fl">30</span><span class="op">)</span>, <span class="st">"11111"</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span><span class="va">loc</span> <span class="op">=</span> <span class="fu"><a href="../reference/sfc_segments.html">sfc_segments</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">loc</span><span class="op">)</span></span>
<span><span class="va">col_fun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">colorRamp2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span>, length <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>, <span class="fu">RColorBrewer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span><span class="fl">11</span>, <span class="st">"Spectral"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/spiralize" class="external-link">spiralize</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://jokergoo.github.io/spiralize/reference/spiral_initialize.html" class="external-link">spiral_initialize</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, start <span class="op">=</span> <span class="fl">360</span>, end <span class="op">=</span> <span class="fl">360</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://jokergoo.github.io/spiralize/reference/spiral_track.html" class="external-link">spiral_track</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">0.95</span>, background <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://jokergoo.github.io/spiralize/reference/spiral_segments.html" class="external-link">spiral_segments</a></span><span class="op">(</span><span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">loc</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span>, <span class="fl">2</span><span class="op">]</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu">col_fun</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="hilbert_curve_files/figure-html/unnamed-chunk-27-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
