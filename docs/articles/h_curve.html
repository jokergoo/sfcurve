<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sfcurve">
<title>H-Curve • sfcurve</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="H-Curve">
<meta property="og:description" content="sfcurve">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sfcurve</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/sfc_2x2.html">1. 2x2 space-Filling Curve</a>
    <a class="dropdown-item" href="../articles/peano_curve.html">2. 3x3 Peano Curve</a>
    <a class="dropdown-item" href="../articles/meander_curve.html">3. 3x3 Meander Curve</a>
    <a class="dropdown-item" href="../articles/unit_flipping.html">4. Unit flipping</a>
    <a class="dropdown-item" href="../articles/standard_curves.html">5. Standard curves</a>
    <a class="dropdown-item" href="../articles/all_3x3_curve.html">6. General 3x3 Curves</a>
    <a class="dropdown-item" href="../articles/meander_4x4_curve.html">7. 4x4 Meander Curve</a>
    <a class="dropdown-item" href="../articles/nxn_curve.html">8. General nxn Curves</a>
    <a class="dropdown-item" href="../articles/h_curve.html">9. H-Curve</a>
    <a class="dropdown-item" href="../articles/hilbert_3d.html">10. 3D Hilbert curve</a>
    <a class="dropdown-item" href="../articles/locality.html">11. Locality of various curves</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/functions.html">Functions/Classes</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jokergoo/sfcurve/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>H-Curve</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 data-toc-skip class="date">2024-09-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/sfcurve/blob/HEAD/vignettes/h_curve.Rmd" class="external-link"><code>vignettes/h_curve.Rmd</code></a></small>
      <div class="d-none name"><code>h_curve.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="construction-and-expansion">Construction and expansion<a class="anchor" aria-label="anchor" href="#construction-and-expansion"></a>
</h2>
<p>H-curve has the following two base units: an H-shape unit <span class="math inline">\(H_1\)</span> and its rotated version <span class="math inline">\(H_2\)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span><span class="va">H1</span>, <span class="va">H2</span>, nrow <span class="op">=</span> <span class="fl">1</span>, closed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="h_curve_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;"></p>
<p>To recursively expand it to higher levels, we can replace the four corners (each corner is represented as 2x2 grids) into full H-units. Or we can also do in a copy-paste way where we put the four copies of the H-unit in the four quadrants and connect them in the 1-2-3-4 order as in the following figure:</p>
<p><img src="h_curve_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;"></p>
<p>To connect two units, the corners in the corresponding units need to be opened. Take unit 1 as an example, as it connects to unit 2 via its topright corner, there are two ways to open this corner: to open the horizontal segment and the vertical segment (the red and blue segments). This process is similar for unit 2-4. We name the openning of the horizontal segment as <code>"h"</code> and the openning of the vertical segment as <code>"v"</code>. See the next two plots:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/h_curve.html">sfc_h</a></span><span class="op">(</span><span class="va">H1</span>, iteration <span class="op">=</span> <span class="fl">1</span>, connect <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/h_curve.html">sfc_h</a></span><span class="op">(</span><span class="va">H1</span>, iteration <span class="op">=</span> <span class="fl">1</span>, connect <span class="op">=</span> <span class="st">"v"</span><span class="op">)</span>,</span>
<span>    closed <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="h_curve_files/figure-html/unnamed-chunk-4-1.png" width="864" style="display: block; margin: auto;"></p>
<p>Then, denote <span class="math inline">\(H^{(0)}\)</span> as the base unit of H-curve, <span class="math inline">\(H^{(1)}\)</span> as the H-curve after the first iteration. We can have the following expansion rule:</p>
<p><span class="math display">\[ H^{(1)} = H^{(0)} \cdot c \cdot H^{(0)} \cdot c \cdot H^{(0)} \cdot c \cdot H^{(0)} \cdot c, \quad c \in \{h, v\} \]</span></p>
<p>where the four <span class="math inline">\(H^{(0)}\)</span> have the order of 1-2-3-4, <span class="math inline">\(c\)</span> is the action of how two units are connected and it takes values of <span class="math inline">\(h\)</span> (open the horiozntal segment) and <span class="math inline">\(v\)</span> (open the vertical segment). The fourth <span class="math inline">\(H^{(0)}\)</span> connects back to the first <span class="math inline">\(H^{(0)}\)</span>.</p>
<p>As there are two types of base units for the H-curve: <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span>, the four <span class="math inline">\(H^{(0)}\)</span> actually can be differently and independently selected. Then we can change the previous equation to:</p>
<p><span class="math display">\[ H^{(1)} = H_1^{(0)} \cdot c \cdot H_2^{(0)} \cdot c \cdot H_3^{(0)} \cdot c \cdot H_4^{(0)} \cdot c, \quad H_i^{(0)} \in \{H_1, H_2\}, i \in \{1..4\}\]</span></p>
<p>The next plots show all the forms of H-curves after the first iteration, with the connection method “h”:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H1</span>, <span class="va">H1</span>, <span class="va">H1</span>, <span class="va">H1</span><span class="op">)</span>, <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H1</span>, <span class="va">H1</span>, <span class="va">H1</span>, <span class="va">H2</span><span class="op">)</span>, <span class="co"># "h" is the default</span></span>
<span>    <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H1</span>, <span class="va">H1</span>, <span class="va">H2</span>, <span class="va">H1</span><span class="op">)</span>, <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H1</span>, <span class="va">H1</span>, <span class="va">H2</span>, <span class="va">H2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H1</span>, <span class="va">H2</span>, <span class="va">H1</span>, <span class="va">H1</span><span class="op">)</span>, <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H1</span>, <span class="va">H2</span>, <span class="va">H1</span>, <span class="va">H2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H1</span>, <span class="va">H2</span>, <span class="va">H2</span>, <span class="va">H1</span><span class="op">)</span>, <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H1</span>, <span class="va">H2</span>, <span class="va">H2</span>, <span class="va">H2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H2</span>, <span class="va">H1</span>, <span class="va">H1</span>, <span class="va">H1</span><span class="op">)</span>, <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H2</span>, <span class="va">H1</span>, <span class="va">H1</span>, <span class="va">H2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H2</span>, <span class="va">H1</span>, <span class="va">H2</span>, <span class="va">H1</span><span class="op">)</span>, <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H2</span>, <span class="va">H1</span>, <span class="va">H2</span>, <span class="va">H2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H2</span>, <span class="va">H2</span>, <span class="va">H1</span>, <span class="va">H1</span><span class="op">)</span>, <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H2</span>, <span class="va">H2</span>, <span class="va">H1</span>, <span class="va">H2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H2</span>, <span class="va">H2</span>, <span class="va">H2</span>, <span class="va">H1</span><span class="op">)</span>, <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H2</span>, <span class="va">H2</span>, <span class="va">H2</span>, <span class="va">H2</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">2</span>, closed <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="h_curve_files/figure-html/unnamed-chunk-5-1.png" width="864" style="display: block; margin: auto;"></p>
<p>More generally, we can generalize the previous equation to any step of the iteration <span class="math inline">\(k\)</span>:</p>
<p><span class="math display">\[ H^{(k)} = H_1^{(k-1)} \cdot c \cdot H_2^{(k-1)} \cdot c \cdot H_3^{(k-1)} \cdot c \cdot H_4^{(k-1)} \cdot c, \quad k \ge 1\]</span></p>
</div>
<div class="section level2">
<h2 id="number-of-different-forms">Number of different forms<a class="anchor" aria-label="anchor" href="#number-of-different-forms"></a>
</h2>
<p>After the first iteration, the total number of forms of the H-curve denoted as <span class="math inline">\(n_1\)</span> is</p>
<p><span class="math display">\[ n_1 = n_0^4 \cdot 2 \]</span></p>
<p>where <span class="math inline">\(n_0\)</span> is the number of different forms of base patterns, which is 2. The second 2 is the number of connection method, i.e. “h” and “v”.</p>
<p>Similally, we can write the numbers of forms for other iterations:</p>
<p><span class="math display">\[
\begin{align*}
n_2 &amp;= n_1^4 \cdot 2 \\
n_3 &amp;= n_2^4 \cdot 2 \\
 &amp; ... \\
n_k &amp;= n_{k-1}^4 \cdot 2\\
\end{align*}
\]</span></p>
<p>Then we can have the number of different forms of H-curve after iteration <span class="math inline">\(k\)</span>, taking <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> as the base units:</p>
<p><span class="math display">\[
n_k = 2^{4^k + 4^{k-1} + ... + 4 + 1} = 2^{\sum_{i=0}^k{4^i}} =  2^{\frac{4^{k+1}-1}{3}} 
\]</span></p>
<p>It shows after iteration <span class="math inline">\(k\)</span>, each form can be assigned to an unique sequence of binary bits with length of <span class="math inline">\((4^{k+1}-1)/3\)</span>.</p>
</div>
<div class="section level2">
<h2 id="more-general-forms">More general forms<a class="anchor" aria-label="anchor" href="#more-general-forms"></a>
</h2>
<p>More generally, <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> can be thought as being built on an even smaller unit <span class="math inline">\(H_0\)</span>:</p>
<p><span class="math display">\[
\begin{align*}
H_1 &amp;= H_0 \cdot h \cdot H_0 \cdot h \cdot H_0 \cdot h \cdot H_0 \cdot h \\
H_2 &amp;= H_0 \cdot v \cdot H_0 \cdot v \cdot H_0 \cdot v \cdot H_0 \cdot v \\
\end{align*}
\]</span></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">H0</span>, </span>
<span>    <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H0</span>, connect <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">H0</span>, connect <span class="op">=</span> <span class="st">"v"</span><span class="op">)</span>,</span>
<span>    closed <span class="op">=</span> <span class="cn">TRUE</span>, nrow <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="h_curve_files/figure-html/unnamed-chunk-6-1.png" width="720" style="display: block; margin: auto;"></p>
<p>Also the connection methods for the four units are not necessary to be the same. In the followng example, we take <span class="math inline">\(H_0\)</span> as the base unit and take <code>vhvh</code> as the connection methods, i.e. the vertical segment of the first unit, the horizontal segment of the second unit, the vertical segment of the third unit and the horizontal segment of the fourth segment are opened, and we do five iterations:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">h</span>, <span class="va">iteration</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">iteration</span><span class="op">)</span> <span class="va">h</span> <span class="op">=</span> <span class="fu"><a href="../reference/h_curve.html">expand_h</a></span><span class="op">(</span><span class="va">h</span>, connect <span class="op">=</span> <span class="st">"vhvh"</span><span class="op">)</span></span>
<span>    <span class="va">h</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">fun</span><span class="op">(</span><span class="va">H0</span>, <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/plot_segments.html">plot_segments</a></span><span class="op">(</span>closed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="h_curve_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="global-structure-is-unchanged">Global structure is unchanged<a class="anchor" aria-label="anchor" href="#global-structure-is-unchanged"></a>
</h2>
<p>Although H-curve has a large number of different forms, different settings only affect folding locally in the curve, while its global structure is still unchanged:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="../reference/h_curve.html">sfc_h</a></span><span class="op">(</span><span class="va">H1</span>, iteration <span class="op">=</span> <span class="fl">3</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="../reference/h_curve.html">sfc_h</a></span><span class="op">(</span><span class="va">H1</span>, iteration <span class="op">=</span> <span class="fl">3</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">=</span> <span class="fu"><a href="../reference/h_curve.html">sfc_h</a></span><span class="op">(</span><span class="va">H1</span>, iteration <span class="op">=</span> <span class="fl">5</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">=</span> <span class="fu"><a href="../reference/h_curve.html">sfc_h</a></span><span class="op">(</span><span class="va">H1</span>, iteration <span class="op">=</span> <span class="fl">5</span>, random <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="h_curve_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The next plots show distances of points with the same indicies on two random H-curves, normalized by the “sizes” of the curves. We can see the distance difference is very small.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">d1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">p1</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">p2</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">p1</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">p2</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d1</span>, type <span class="op">=</span> <span class="st">"h"</span>, main <span class="op">=</span> <span class="st">"iter = 3"</span>, xlab <span class="op">=</span> <span class="st">"Sequential points on H-curve"</span>, ylab <span class="op">=</span> <span class="st">"distance"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">p3</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">p4</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">p3</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">p4</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">d2</span>, type <span class="op">=</span> <span class="st">"h"</span>, main <span class="op">=</span> <span class="st">"iter = 5"</span>, xlab <span class="op">=</span> <span class="st">"Sequential points on H-curve"</span>, ylab <span class="op">=</span> <span class="st">"distance"</span><span class="op">)</span></span></code></pre></div>
<p><img src="h_curve_files/figure-html/unnamed-chunk-9-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
