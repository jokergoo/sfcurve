<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sfcurve">
<title>Standard curves • sfcurve</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Standard curves">
<meta property="og:description" content="sfcurve">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sfcurve</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hilbert_curve.html">1. Generalized Hilbert Curve</a>
    <a class="dropdown-item" href="../articles/peano_curve.html">2. Generalized Peano Curve</a>
    <a class="dropdown-item" href="../articles/meander_curve.html">3. Generalized Meander Curve</a>
    <a class="dropdown-item" href="../articles/unit_flipping.html">4. Unit flipping</a>
    <a class="dropdown-item" href="../articles/standard_curves.html">5. Standard curves</a>
    <a class="dropdown-item" href="../articles/all_3x3_curve.html">6. 3x3 Curve</a>
    <a class="dropdown-item" href="../articles/meander_4x4_curve.html">7. 4x4 Meander Curve</a>
    <a class="dropdown-item" href="../articles/nxn_curve.html">8. General nxn Curves</a>
    <a class="dropdown-item" href="../articles/h_curve.html">9. H-Curve</a>
    <a class="dropdown-item" href="../articles/hilbert_3d.html">10. 3D Hilbert curve</a>
    <a class="dropdown-item" href="../articles/locality.html">11. Locality of various curves</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/functions.html">Functions/Classes</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/jokergoo/sfcurve/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Standard curves</h1>
                        <h4 data-toc-skip class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 data-toc-skip class="date">2024-07-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/sfcurve/blob/HEAD/vignettes/standard_curves.Rmd" class="external-link"><code>vignettes/standard_curves.Rmd</code></a></small>
      <div class="d-none name"><code>standard_curves.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="x2-standard-curves">2x2 standard curves<a class="anchor" aria-label="anchor" href="#x2-standard-curves"></a>
</h2>
<div class="section level3">
<h3 id="hilbert-curve-and-moore-curve">Hilbert curve and Moore curve<a class="anchor" aria-label="anchor" href="#hilbert-curve-and-moore-curve"></a>
</h3>
<p>Both standard Hilbert curve and Moore curve use the “Hilbert level-2 unit”:</p>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-2-1.png" width="192" style="display: block; margin: auto;"></p>
<p>while on the global level, Hilbert curve uses the “Hilbert structure” (left) while Moore curve uses the “Moore structure” (right):</p>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-3-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Let’s check the standard Hilbert curve on various levels and their structures. Note Moore curve still uses the Hilbert structure on lower levels.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/standard_curve.html">hilbert_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">grob</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># a null grob, a place holder</span></span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span>, padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-4-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/standard_curve.html">moore_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">grob</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># a null grob, a place holder</span></span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span>, padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-5-1.png" width="768" style="display: block; margin: auto;"></p>
<p>As a comparison, general Hilbert curves may not have the “Hilbert structure” on some higher levels:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="st">"21211"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">1</span>, padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-6-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The functions <code><a href="../reference/standard_curve.html">hilbert_curve()</a></code> and <code><a href="../reference/standard_curve.html">moore_curve()</a></code> are generated by the more general function <code><a href="../reference/spacefilling.html">sfc_hilbert()</a></code> by choosing specific base patterns and transverse path. For example, a standard Hilbert curve on level 5 is:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"R"</span>, code <span class="op">=</span> <span class="st">"11111"</span><span class="op">)</span></span></code></pre></div>
<p>And a standard Moore curve on level 5 is (where the last two digits should be <code>21</code>):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"C"</span>, code <span class="op">=</span> <span class="st">"11121"</span>, rot <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="beta-omega-curve">Beta-Omega curve<a class="anchor" aria-label="anchor" href="#beta-omega-curve"></a>
</h3>
<p>The <span class="math inline">\(\beta\Omega\)</span>-curve (<a href="https://doi.org/10.1007/978-3-642-31046-1" class="external-link">Michael Bader. Space-Filling Curves: An Introduction with Applications in Scientific Computing, 2012 Springer, Figure 7.7</a>) uses the <span class="math inline">\(\beta\)</span> (left) and the <span class="math inline">\(\Omega\)</span> (right) units.</p>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-7-1.png" width="384" style="display: block; margin: auto;"></p>
<p>It uses the “Moore global structure”:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/standard_curve.html">beta_omega_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">grob</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># a null grob, a place holder</span></span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span>, padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-8-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The function <code><a href="../reference/standard_curve.html">beta_omega_curve()</a></code> is also generated by <code><a href="../reference/spacefilling.html">sfc_hilbert()</a></code>. E.g., a <span class="math inline">\(\beta\Omega\)</span>-curve on level 5 is actually (digits <code>1</code> and <code>2</code> are in turn):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/spacefilling.html">sfc_hilbert</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"12121"</span>, rot <span class="op">=</span> <span class="op">-</span><span class="fl">90</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="x3-standard-curves">3x3 standard curves<a class="anchor" aria-label="anchor" href="#x3-standard-curves"></a>
</h2>
<div class="section level3">
<h3 id="peano-curve">Peano curve<a class="anchor" aria-label="anchor" href="#peano-curve"></a>
</h3>
<p>The basic unit in the Peano curve has two different forms: vertical (left) and horizontal (right) (of course their flipped versions):</p>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-9-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The standard Peano curve requires all these units on various levels to be vertical.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/standard_curve.html">peano_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">grob</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># a null grob, a place holder</span></span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span>, padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-10-1.png" width="864" style="display: block; margin: auto;"></p>
<p>The general Peano curve has a huge number of different forms by flipping units on various level. But we can still generate a Peano curve with specific patterns on low levels (e.g. on level-1).</p>
<p><code><a href="../reference/standard_curve.html">peano_curve()</a></code> has an argument <code>pattern</code> which defines the patterns on level-1. Since the unit can be flipped either vertically or horizontally, the value for <code>pattern</code> should be a string of <code>"v"</code> and <code>"h"</code> that controls how the level-1 units are selected and compose to level-2. The maximal number of letters in <code>pattern</code> should not exeed 9. If it is shorter than 9, it will be automatically recycled.</p>
<p>We can set different combination patterns of “vertical units” and “horizontal units”. For example, the Peano curve in the different switch-back types (<a href="https://link.springer.com/book/10.1007/978-1-4612-0871-6" class="external-link">Hans Sagan, Space-Filling Curves, 1994 Springer, Figure 3.7.1</a>)</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/standard_curve.html">peano_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span>, pattern <span class="op">=</span> <span class="st">"vh"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/standard_curve.html">peano_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span>, pattern <span class="op">=</span> <span class="st">"h"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/standard_curve.html">peano_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span>, pattern <span class="op">=</span> <span class="st">"hv"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/standard_curve.html">peano_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span>, pattern <span class="op">=</span> <span class="st">"vvvhhhvvv"</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-11-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Since <code>pattern</code> is applied to every level in the curve generation, if you want the nine level-1 units with the pattern <code>"vvvhhhvvv"</code> only applied on level-1, you have to first generate a all-v curve then adjust the 1-3, 7-8 subunits to vertical and the 4-6 subunits to horizontal.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/spacefilling.html">sfc_peano</a></span><span class="op">(</span><span class="st">"I"</span>, level <span class="op">=</span> <span class="fl">3</span>, flip <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span><span class="op">@</span><span class="va">rot</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">270</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/sfc_apply.html">sfc_apply</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">u</span>, <span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">9</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="../reference/level1_unit.html">level1_unit_orientation</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">==</span> <span class="st">"horizontal"</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="../reference/sfc_flip_unit.html">sfc_flip_unit</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">u</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="../reference/level1_unit.html">level1_unit_orientation</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="op">==</span> <span class="st">"vertical"</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="../reference/sfc_flip_unit.html">sfc_flip_unit</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">u</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-12-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="meander-curve">Meander curve<a class="anchor" aria-label="anchor" href="#meander-curve"></a>
</h3>
<p>The Peano curve in the meander type (<a href="https://link.springer.com/book/10.1007/978-1-4612-0871-6" class="external-link">Hans Sagan, Space-Filling Curves, 1994 Springer, Figure 3.7.3</a>). It has the basic unit forms: forward (left) and backward (right). If thinking the top part of the unit representing the direction of the “wave”, then forward means the direction of the wave is the same as the direction of the curve and verse visa for backward.</p>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-13-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The expanding rules in <code><a href="../reference/draw_rules.html">draw_rules_meander()</a></code> use the “forward” unit for all patterns with transverse code 1.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/standard_curve.html">meander_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.grob.html" class="external-link">grob</a></span><span class="op">(</span><span class="op">)</span>,  <span class="co"># a null grob, a place holder</span></span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_grob.html">sfc_grob</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/sfc_reduce.html">add_base_structure</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/sfc_reduce.html">sfc_reduce</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span>, padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-14-1.png" width="864" style="display: block; margin: auto;"></p>
<p>We can also control the individual directions of level-1 units.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_multiple_curves.html">draw_multiple_curves</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/standard_curve.html">meander_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span>, pattern <span class="op">=</span> <span class="st">"fb"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/standard_curve.html">meander_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span>, pattern <span class="op">=</span> <span class="st">"fffffbbbb"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/standard_curve.html">meander_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span>, pattern <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/standard_curve.html">meander_curve</a></span><span class="op">(</span>level <span class="op">=</span> <span class="fl">3</span>, pattern <span class="op">=</span> <span class="st">"fffbbb"</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span>, padding <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">4</span>, <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="standard_curves_files/figure-html/unnamed-chunk-15-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
